/*
 * File: main.cpp
 * Author: Daniel Neri Cardoso
 * Project: ProVANT
 * Company: Federal University of Minas Gerais
 * Version: 1.0
 * Date: 2021
 * Description: This file is responsible to implement Adaptive Mixing control law to VANT3.0
 * The mathematical background used to design this controller is presented in "A new robust adaptive mixing control for
trajectory tracking with improved forward flight of a tilt-rotor UAV" that is published in Journal ISA transactions -
Elsevier, from authors: Cardoso, Daniel N and Esteban, Sergio and Raffo, Guilherme V, and is available at
https://www.sciencedirect.com/science/article/abs/pii/S0019057820304432
 */

#include <control_strategies_base/icontroller.hpp>
#include <Eigen/Eigen>
#include <iostream>
#include "simulator_msgs/Sensor.h"
#include <cmath>

struct Double322
{
  double Val[3][2][2];
};

class vant3_adaptiveMixCtrl2 : public Icontroller
{
private:
  double e;

private:
  double pi;

  // integrators
private:
  double T;

  // Mapeamento
private:
  Eigen::MatrixXd RI_B;

private:
  Eigen::MatrixXd Wn;

  // dynamic controller
private:
  Eigen::MatrixXd K;

private:
  Eigen::MatrixXd Qu;

private:
  Eigen::MatrixXd Yu;

private:
  Eigen::MatrixXd Q111;

private:
  Eigen::MatrixXd Q112;

private:
  Eigen::MatrixXd Q121;

private:
  Eigen::MatrixXd Q122;

private:
  Eigen::MatrixXd Q211;

private:
  Eigen::MatrixXd Q212;

private:
  Eigen::MatrixXd Q221;

private:
  Eigen::MatrixXd Q222;

private:
  Eigen::MatrixXd Q311;

private:
  Eigen::MatrixXd Q312;

private:
  Eigen::MatrixXd Q321;

private:
  Eigen::MatrixXd Q322;

private:
  Eigen::MatrixXd Y111;

private:
  Eigen::MatrixXd Y112;

private:
  Eigen::MatrixXd Y121;

private:
  Eigen::MatrixXd Y122;

private:
  Eigen::MatrixXd Y211;

private:
  Eigen::MatrixXd Y212;

private:
  Eigen::MatrixXd Y221;

private:
  Eigen::MatrixXd Y222;

private:
  Eigen::MatrixXd Y311;

private:
  Eigen::MatrixXd Y312;

private:
  Eigen::MatrixXd Y321;

private:
  Eigen::MatrixXd Y322;

private:
  Eigen::VectorXd Uref;

private:
  Eigen::VectorXd X;

private:
  Eigen::VectorXd Xref;

private:
  Eigen::VectorXd Erro;

private:
  Eigen::VectorXd Input;

private:
  Eigen::VectorXd SaveData;

private:
  Eigen::VectorXd SaveDataRef;

private:
  Eigen::VectorXd SaveDataError;

private:
  double Angleref;

  // adaptive mixing
private:
  Eigen::VectorXd center;

private:
  Eigen::VectorXd cutoff;

private:
  std::vector<double> psii;

private:
  std::vector<double> mii;

private:
  double BumpValues[3][2][2];

  // kinematic controller
private:
  Eigen::VectorXd Trajectory;

private:
  Eigen::MatrixXd Kk;

private:
  Eigen::VectorXd Xk;

private:
  Eigen::VectorXd Uk;

private:
  Eigen::VectorXd Dk;

private:
  Eigen::VectorXd Xki;

private:
  Eigen::MatrixXd Kki;

public:
  vant3_adaptiveMixCtrl2()
    : Xref(18, 1)
    , X(18, 1)
    , Erro(18, 1)
    , Input(6, 1)
    , Trajectory(20, 1)
    , K(6, 18)
    , center(6)
    , cutoff(6)
    , psii(6)
    , mii(6)
    , RI_B(3, 3)
    , Wn(3, 3)
    , Kk(3, 3)
    , Xk(3, 1)
    , Uk(3, 1)
    , Dk(3, 1)
    , Uref(6, 1)
    , SaveData(20, 1)
    , SaveDataRef(20, 1)
    , SaveDataError(20, 1)
    , Kki(3, 3)
    , Xki(3, 1)
    , Q111(18, 18)
    , Q112(18, 18)
    , Q121(18, 18)
    , Q122(18, 18)
    , Q211(18, 18)
    , Q212(18, 18)
    , Q221(18, 18)
    , Q222(18, 18)
    , Q311(18, 18)
    , Q312(18, 18)
    , Q321(18, 18)
    , Q322(18, 18)
    , Y111(6, 18)
    , Y112(6, 18)
    , Y121(6, 18)
    , Y122(6, 18)
    , Y211(6, 18)
    , Y212(6, 18)
    , Y221(6, 18)
    , Y222(6, 18)
    , Y311(6, 18)
    , Y312(6, 18)
    , Y321(6, 18)
    , Y322(6, 18)
    , Qu(18, 18)
    , Yu(6, 18)
  {
    e = 2.718281828459046;
    pi = 3.141592653589793;
    T = 0.012;
    // T = 0.0012;
    //		Uref << 8.8,   8.8,  -5.2*pow(10,-4), -5.2*pow(10,-4), 0, 0;
    Uref << 8.46, 8.46, -1.74 * pow(10, -5), -1.74 * pow(10, -5), 0, 0;
    Angleref = 0.0803;

    // New adaptive mixing final version

    Y111 << 0.013415, -0.0080827, -0.26178, 0.41101, -0.01627, 0.15061, -0.34018, 2.5878, -0.017117, 0.011207,
        0.0011203, -0.00116, -0.023271, -0.067679, 0.02589, 0.0033878, 0.0051248, 0.012951, 0.057358, -0.11287,
        -0.29816, -0.36254, 0.11339, -0.25414, 1.5959, -0.78746, -0.00059288, -0.026739, -0.0071755, 0.018512,
        -0.059318, -0.037184, 0.017693, -0.011178, 0.018639, 0.0017828, 0.00050196, 0.00020123, -0.00021987,
        -0.00045799, 0.00091462, 0.0016006, -0.015052, -0.00053589, -2.0957e-05, 4.9886e-05, -8.8516e-05, -0.00010197,
        -6.4817e-05, 0.00014231, 5.0002e-05, -0.00030442, -3.9405e-05, 5.677e-05, 0.00071643, -0.00037114, -0.00032278,
        0.00037281, 0.001871, -0.0017282, -0.00035307, -0.021707, 4.5885e-05, -8.6337e-05, -0.00011877, 0.00013312,
        -3.685e-05, -0.0002437, -1.1389e-05, -0.00037005, 7.0785e-05, -7.8565e-05, -0.010991, -0.0042979, -0.069705,
        0.006465, -0.17448, -0.0032064, 0.4226, 0.47948, 0.0089324, -0.0015535, -0.001537, 0.00079401, 0.0090248,
        0.0092545, 0.0091199, 0.0025587, -0.0014625, -0.00020677, 0.0078459, -0.028029, 0.081077, -0.028175, 0.16186,
        0.013025, -0.50978, -0.59703, -0.0098631, -0.0029285, 0.00060883, 0.00092647, -0.0046507, 0.0016231, -0.014189,
        -0.0082305, -0.009004, 0.00012916;

    Y112 << -0.010344, -0.012638, -0.25477, 0.41025, -0.2201, 0.32117, -0.32629, 3.6032, -0.018457, 0.0088681, 0.006948,
        -0.0066996, -0.01061, -0.052842, 0.026199, -0.0090123, 0.01187, 0.010324, -0.0014344, -0.11689, -0.24224,
        -0.44752, -0.22513, -0.050301, 1.8415, 0.56301, -0.020603, -0.021207, 0.00076257, 0.015743, -0.050455,
        -0.022782, 0.020752, -0.015018, 0.027787, -0.0028021, 0.00050523, 0.00018096, -0.00024625, -0.00049152,
        0.00096536, 0.0015848, -0.014603, -0.00057341, -2.1853e-05, 4.3758e-05, -8.7702e-05, -9.5912e-05, -6.6462e-05,
        0.00010899, 7.3064e-05, -0.00029759, -3.1133e-05, 6.116e-05, 0.00074037, -0.00021143, -0.00019343, 0.00020883,
        0.0019059, -0.0019708, -0.00021354, -0.022424, 1.4643e-05, -1.8124e-05, -0.00011432, 0.00014076, -4.5865e-05,
        -0.00032247, -1.541e-05, -0.00034319, 4.1752e-05, -9.6204e-05, -0.010336, -0.0016855, -0.067422, 0.018631,
        -0.17299, -0.0088909, 0.42715, 0.44914, 0.0084994, -0.0017683, -0.0018448, 0.00030526, 0.0096322, 0.0071848,
        0.0088474, 0.0017675, -0.0014775, 0.00065899, 0.0093754, -0.031448, 0.078575, -0.035796, 0.18093, 0.0043935,
        -0.52029, -0.65953, -0.0076414, -0.0027, 0.00035424, 0.0016278, -0.0062674, 0.0023689, -0.013133, -0.0065536,
        -0.010625, -0.00087815;

    Y121 << -0.046092, 0.0086444, -0.2254, 0.48766, -0.34681, -0.078383, 1.0936, 3.0813, -0.021082, 0.0091761,
        0.0097032, -0.00035005, -0.02377, -0.071475, 0.016752, 0.0052491, -0.0046229, 0.014855, 0.037727, -0.09926,
        -0.28351, -0.35927, -0.070245, -0.40139, 2.1929, -0.90532, -0.016713, -0.025758, -0.003355, 0.019596, -0.036393,
        -0.021327, 0.02747, -0.026696, 0.0093256, 0.0057589, 0.00049881, 8.8169e-05, -0.00020821, -0.00011881, 0.000814,
        0.0017958, -0.015108, 0.00061845, 2.1036e-06, 3.3666e-07, -7.8044e-05, -0.00011405, -0.00016189, 0.00011303,
        2.7325e-05, -0.00026758, -2.2267e-05, 6.1783e-05, 0.00068613, -0.00039176, -0.00029134, 0.00046479, 0.0019482,
        -0.0017718, -0.00085255, -0.021847, 4.3904e-05, -9.6122e-05, -0.00011178, 0.0001224, -3.7815e-05, -0.00027445,
        3.2743e-05, -0.00033042, 7.4238e-05, -7.0215e-05, -0.0094763, -0.010171, -0.066734, -0.018988, -0.17016,
        -0.0054299, 0.42167, 0.47761, 0.0077523, -0.0015906, -0.0016535, 0.0012427, 0.0060621, 0.0087386, 0.0091254,
        0.002709, -0.0016614, -0.00074058, 0.011265, -0.025984, 0.075128, -0.0071368, 0.17697, 0.030371, -0.59011,
        -0.60626, -0.0089051, -0.0030688, 0.00035108, 0.00047489, -0.0030504, 0.0015654, -0.0141, -0.0067082, -0.009158,
        0.00085885;

    Y122 << -0.064833, -0.010912, -0.24306, 0.51128, -0.52764, 0.075504, 0.88327, 3.958, -0.02564, 0.003126, 0.0099342,
        -0.0064732, -0.0095834, -0.057589, 0.012048, -0.00010339, 0.0036451, 0.013213, -0.013529, -0.11008, -0.25934,
        -0.5001, -0.38242, -0.18464, 2.3511, 0.42544, -0.031515, -0.019179, -0.0018539, 0.017166, -0.026194, -0.012448,
        0.021977, -0.018448, 0.018336, 0.00064929, 0.00045908, 0.00010314, -0.00019184, 9.879e-05, 0.00070463,
        0.0019273, -0.014717, 0.0027879, -3.9105e-05, -4.7599e-06, -7.1685e-05, -0.00012764, -0.00014758, 9.9193e-05,
        8.2955e-05, -0.00023534, -3.3641e-05, 7.2314e-05, 0.00067179, -0.0002714, -0.00021505, 0.00012428, 0.0018325,
        -0.0022125, 0.00088602, -0.022475, 2.0357e-05, -2.6758e-05, -0.00010326, 0.00015074, -7.6453e-06, -0.00036455,
        3.9069e-05, -0.00027353, 5.372e-05, -9.1364e-05, -0.0047351, -0.0072738, -0.061609, -0.0085884, -0.15827,
        -0.014728, 0.39574, 0.38283, 0.0066863, -0.0019752, -0.0025974, 0.00086411, 0.0067906, 0.0058297, 0.008503,
        0.0021137, -0.0019526, 0.00010033, 0.0088091, -0.032107, 0.071299, -0.011641, 0.18415, 0.026338, -0.55107,
        -0.59307, -0.0056818, -0.0027088, 0.0010816, 0.0014758, -0.005393, 0.0033372, -0.01197, -0.0049684, -0.011509,
        -0.0001724;

    Y211 << -0.0060618, -0.16946, -0.279, 0.74264, -0.4935, -0.087897, 0.70644, 3.4399, -0.059691, 0.0027244, 0.021865,
        0.0099169, -0.030179, -0.11574, 0.049192, 0.0079476, -0.060775, 0.00095671, 0.064208, -0.40864, -0.39845,
        -0.75793, -0.027854, -0.80023, 3.3149, -1.9999, -0.059109, -0.021104, -0.00063518, 0.028441, -0.050244,
        -0.022449, 0.052051, 0.00086642, -0.06312, 0.012877, 0.0011755, 0.0015285, -0.0020433, -0.00013957, 0.0016651,
        0.0054891, -0.042293, -0.005383, -0.00013743, 1.573e-05, -0.00023706, -0.000329, 0.00018631, 0.00083503,
        0.00013287, -0.00084333, 4.8103e-05, 2.301e-05, 0.0017912, -0.0026686, -0.0030747, -0.00067782, 0.0072144,
        -0.0046867, -0.0070356, -0.057938, -9.7913e-05, -5.1044e-05, -0.00041432, 0.00030137, 0.00024301, 0.00014152,
        0.0001973, -0.00066852, 0.0001648, -3.4414e-06, -0.0199, 0.023095, -0.053929, -0.0087599, -0.64031, 0.073546,
        0.80223, 1.3777, -0.0012691, -0.00047112, 0.0016984, -0.0050158, 0.015801, 0.020392, -0.0050182, -0.038401,
        -0.0021214, -0.0012064, 0.026919, -0.12576, 0.018636, -0.01606, 0.60354, 0.015153, -0.99545, -1.3748, 0.0029765,
        -0.0019834, -0.0078287, 0.011005, -0.019015, 0.0064622, -0.0032326, 0.024798, -0.0051142, -9.3701e-05;

    Y212 << 0.020152, -0.11802, -0.36104, 0.84015, -0.71364, 0.26083, 0.18185, 5.0125, -0.088502, 0.0039515, 0.010082,
        0.0011766, -0.020171, -0.10508, 0.062046, -0.019812, -0.025531, -0.0088426, 0.0023883, -0.39506, -0.40994,
        -0.92153, -0.58939, -0.38325, 2.9399, 0.14619, -0.061338, -0.015288, -0.0042631, 0.031581, -0.048674, -0.01923,
        0.035472, 0.0029645, -0.028347, 0.00069237, 0.0012056, 0.0014503, -0.0020584, 0.0014101, 0.0016409, 0.0057303,
        -0.0432, -0.0020252, -0.00017184, -5.3534e-05, -0.00023749, -0.00034183, 0.00016424, 0.00082746, 0.0001994,
        -0.00085582, 2.6954e-05, 2.1411e-05, 0.0018368, -0.0032271, -0.0029699, -0.00027939, 0.007266, -0.0058123,
        -0.0044334, -0.06343, -6.5176e-05, -2.5163e-05, -0.00040896, 0.0004032, 0.00021842, -7.6273e-05, 0.0002085,
        -0.00057979, 0.00017007, -1.1773e-05, -0.021981, 0.010677, -0.057797, 0.038315, -0.63138, 0.065126, 0.85107,
        1.3464, -0.0014152, -0.0033684, 0.0011556, -0.0056615, 0.015294, 0.019225, -0.0030791, -0.033219, -0.002773,
        -0.00086429, 0.028663, -0.12759, 0.031157, -0.049937, 0.62403, -1.0088e-05, -1.0064, -1.4918, 0.0056409,
        0.0012916, -0.0070703, 0.012826, -0.019961, 0.0085892, -0.0045644, 0.022028, -0.0075101, -0.00053454;

    Y221 << -0.064423, -0.13709, -0.27751, 0.84584, -0.99831, -0.51536, 2.5717, 3.7266, -0.073444, 0.006699, 0.020711,
        0.010267, -0.031707, -0.13285, 0.044265, 0.019152, -0.085901, 0.0077439, 0.10561, -0.4171, -0.50905, -0.92312,
        -0.10724, -1.0364, 3.9591, -2.8854, -0.096002, -0.020128, -0.015793, 0.032307, -0.032146, -0.009287, 0.071072,
        -0.035896, -0.078007, 0.0077477, 0.0010975, 0.0017243, -0.0017577, -0.00062977, 0.0011901, 0.0058215, -0.04203,
        -0.0011278, -0.00015008, 1.047e-05, -0.00021341, -0.00033647, 6.6614e-05, 0.00076473, 0.00015557, -0.00070308,
        1.1799e-05, -3.053e-06, 0.0017889, -0.0026595, -0.0030159, -0.0014194, 0.0070479, -0.0048052, -0.0038008,
        -0.056675, -0.0001431, -5.8179e-05, -0.000407, 0.00029905, 0.00019945, 0.00010442, 0.00026814, -0.00060535,
        0.00016133, -2.3037e-05, -0.019806, 0.026429, -0.051965, -0.068647, -0.62498, 0.083674, 0.76856, 1.4213,
        -0.0014856, 0.0010108, 0.00090095, -0.005267, 0.014679, 0.019859, -0.0042351, -0.031689, -0.0034549, -0.0014183,
        0.027279, -0.12983, 0.018426, 0.041944, 0.61216, 0.032851, -1.067, -1.3912, 0.0047231, -0.0033002, -0.0061685,
        0.011157, -0.019963, 0.0067823, -0.0044428, 0.021311, -0.0022735, -9.2253e-05;

    Y222 << -0.052006, -0.085982, -0.36662, 0.99207, -1.1742, -0.28273, 1.871, 4.8242, -0.098962, 0.007919, 0.0080174,
        -0.001053, -0.0099343, -0.13014, 0.05581, -0.0044368, -0.062793, -0.0034344, 0.012373, -0.44119, -0.49925,
        -1.1049, -0.71415, -0.58533, 3.8383, -0.40272, -0.089773, -0.014597, -0.015525, 0.031837, -0.033819, -0.013629,
        0.05215, -0.020049, -0.045289, 0.0026566, 0.0010723, 0.0019722, -0.0018072, 0.00095924, 0.00099026, 0.0063207,
        -0.044365, 0.0040919, -0.00018502, -3.3843e-05, -0.0002112, -0.0004167, 2.9819e-06, 0.00072143, 0.00025174,
        -0.0006876, -1.3928e-05, 5.9197e-06, 0.0018492, -0.0034595, -0.003061, -0.0012344, 0.0069163, -0.006396,
        0.00072327, -0.064602, -9.4573e-05, -3.2466e-05, -0.00040702, 0.00043921, 0.00016759, -0.00013894, 0.00026728,
        -0.00051855, 0.00016425, -1.4919e-05, -0.019738, 0.018331, -0.058801, -0.0088963, -0.61196, 0.075071, 0.79918,
        1.3648, -0.0013999, -0.0018888, -0.0001559, -0.0060338, 0.013721, 0.018003, -0.0023559, -0.02567, -0.0043893,
        -0.001423, 0.028607, -0.14145, 0.030725, -0.00107, 0.62704, 0.026898, -1.0668, -1.4728, 0.0068628, 1.854e-05,
        -0.0051467, 0.013787, -0.021553, 0.011217, -0.0057989, 0.017201, -0.0045798, -0.00085623;

    Y311 << -0.59606, -0.47195, -0.11792, 1.7927, -1.8813, -0.53849, 9.0739, 12.406, -0.16383, -0.0034288, 0.068174,
        -0.0072316, -0.046768, -0.24479, 0.071007, 0.10374, -0.12397, 0.00662, -0.23734, -1.2692, -0.91951, -1.2756,
        0.36662, -1.9999, 6.9177, -6.9737, -0.20402, -0.048613, -0.013644, 0.075927, -0.076012, 0.053562, 0.10928,
        -0.0073279, -0.099499, 0.0074127, 0.0019092, 0.0028113, -0.0012766, -0.0035779, 0.0063937, 0.0074578, -0.086904,
        -0.028819, -0.00080608, -6.979e-05, -0.00021551, -0.00024029, -3.239e-05, 0.0010013, 0.00038493, -0.0010063,
        5.9139e-05, -6.3092e-05, 0.0042463, -0.007638, -0.0052792, 1.1029e-05, 0.022885, -0.0074347, -0.050953,
        -0.14295, -0.00076004, -0.0002266, -0.00070258, 0.00056351, -0.00017627, 5.7691e-05, 0.0001343, -0.0010312,
        5.4754e-05, -2.5243e-05, -0.073454, 0.054777, -0.049846, -0.13416, -0.95043, 0.10137, 1.753, 2.2753, -0.016917,
        -0.00040994, 0.0033832, -0.0057802, 0.031037, 0.040887, 0.0018319, -0.05291, -0.011071, -0.0020879, 0.096894,
        -0.24015, -0.03822, 0.006844, 0.91599, 0.17363, -2.695, -2.4073, 0.016767, -0.0055581, -0.011796, 0.014206,
        -0.036898, 0.0105, -0.018214, 0.0051885, 0.0050959, -0.001355;

    Y312 << -0.53385, -0.40661, -0.36976, 1.3925, -1.8952, 0.077397, 5.2029, 11.778, -0.15201, 0.01779, 0.04906,
        -0.012056, -0.010544, -0.19093, 0.071976, 0.040772, -0.066496, 0.0074314, -0.44248, -1.3241, -0.63928, -1.3696,
        -1.3409, -1.3201, 10.714, -2.0451, -0.18223, -0.031158, 0.011315, 0.060511, -0.071782, 0.068573, 0.087842,
        -0.018983, -0.059109, 0.024726, 0.0020619, 0.003018, -0.0016496, -0.00064183, 0.005474, 0.0089381, -0.094012,
        -0.016525, -0.0010127, -0.00015436, -0.00024017, -0.00037761, -8.0107e-05, 0.00097661, 0.0005413, -0.0010147,
        8.6338e-05, -8.1013e-05, 0.003714, -0.0091937, -0.0042996, 0.00061213, 0.021151, -0.0097244, -0.03499, -0.13709,
        -0.00071511, -9.7846e-05, -0.00063091, 0.0007055, -0.00014575, -7.8081e-05, 0.00011596, -0.00083532,
        -8.2281e-06, -3.5263e-05, -0.068844, 0.049814, -0.060104, 0.0015234, -0.93059, 0.1132, 1.7076, 2.1025,
        -0.017644, -0.0057113, 0.0018425, -0.0076675, 0.029275, 0.037163, 0.0026439, -0.048666, -0.0087967, -0.003631,
        0.091822, -0.27646, -0.021172, -0.044481, 0.95652, 0.14873, -2.6457, -2.3629, 0.016186, -0.001519, -0.011481,
        0.01802, -0.039402, 0.013555, -0.017089, 0.0090924, -0.0020172, -0.0036266;

    Y321 << -0.73854, -0.11609, 0.036937, 1.8002, -2.6889, -1.7243, 12.113, 12.684, -0.23733, 0.018569, 0.076743,
        -0.015917, -0.012497, -0.29007, 0.082946, 0.093734, -0.23649, 0.030506, -0.25492, -0.93736, -0.89114, -1.2732,
        0.45318, -2.3552, 7.6388, -7.2765, -0.28802, -0.038161, -0.016801, 0.064091, -0.095717, 0.021986, 0.12663,
        -0.025118, -0.17066, 0.0085989, 0.0013807, 0.0026289, -0.00099325, -0.0039262, 0.0037722, 0.0073317, -0.075033,
        -0.016372, -0.00080674, -0.00017916, -0.00017696, -0.00030614, -0.00010298, 0.00085443, 0.00025355, -0.00073405,
        -3.294e-05, -0.00012, 0.0041603, -0.0076325, -0.0055088, -2.2147e-05, 0.022207, -0.0074807, -0.036922, -0.13971,
        -0.00055259, -0.00025704, -0.00067309, 0.00055801, -0.00047526, 0.00010136, 4.9864e-05, -0.00092141, 0.00012044,
        -5.11e-05, -0.054788, 0.051995, -0.072983, -0.19905, -0.91922, 0.13591, 1.5026, 2.2063, -0.016335, -0.00016979,
        0.00042606, -0.0066387, 0.025522, 0.041206, -0.0016867, -0.04799, -0.0086461, -0.0038541, 0.085068, -0.25679,
        -0.029592, 0.094201, 0.91811, 0.19514, -2.6087, -2.3508, 0.02207, -0.0058995, -0.008446, 0.015238, -0.03595,
        0.009421, -0.019097, 0.0020457, 0.0054952, -0.00029613;

    Y322 << -0.67793, -0.22556, -0.17695, 1.4005, -2.6416, -1.074, 8.353, 12.087, -0.17639, 0.03318, 0.062704,
        -0.022939, 0.0011561, -0.25925, 0.075466, 0.056528, -0.15501, 0.034867, -0.40343, -1.1373, -0.74348, -1.5023,
        -0.91928, -1.6613, 10.222, -3.9262, -0.23883, -0.011362, -0.002038, 0.058712, -0.081179, 0.036118, 0.12733,
        -0.049551, -0.10893, 0.025934, 0.00141, 0.003204, -0.001176, -0.0022642, 0.0020194, 0.0089412, -0.079562,
        -0.0028621, -0.00097788, -0.00018459, -0.00016021, -0.0004709, -0.00021829, 0.00078167, 0.00040889, -0.00072292,
        3.9496e-05, -8.3526e-05, 0.0036119, -0.0091961, -0.0045424, 0.00025371, 0.019895, -0.01036, -0.019432, -0.13208,
        -0.00053775, -7.0212e-05, -0.0005969, 0.00075087, -0.00047086, -0.000192, 4.5468e-07, -0.0007096, -3.363e-05,
        -2.3676e-05, -0.052867, 0.050068, -0.076696, -0.082636, -0.90021, 0.13992, 1.4828, 2.0715, -0.01626, -0.0032846,
        -0.00024304, -0.0079898, 0.0232, 0.036022, -0.0017477, -0.041578, -0.0070387, -0.0043857, 0.082472, -0.29484,
        -0.020889, 0.057105, 0.94087, 0.18996, -2.567, -2.2706, 0.018942, -0.004185, -0.0090978, 0.018679, -0.039761,
        0.017001, -0.017222, 0.0030895, -0.0016688, -0.0043933;

    Q111 << 0.19486, -0.0068283, -0.086181, -0.0062123, 0.0049376, -0.0016956, -0.069076, -0.10946, 0.019426, 0.0002232,
        -0.023426, -5.0623e-05, -0.0015872, 0.0009487, -0.00059513, -0.070706, 0.010989, 0.0052021, -0.0068283, 0.33604,
        0.031925, 0.10518, -0.0027243, 0.057356, -0.080334, 0.11891, -0.0037358, 0.030583, 0.0033258, -0.015559,
        0.0061052, -0.0075728, -0.0077824, -0.0062716, -0.022735, -7.6639e-05, -0.086181, 0.031925, 0.21272, 0.013829,
        -0.021655, 0.0018042, -0.0064686, 0.040139, -0.090525, 0.002856, 0.020463, -0.0016971, 0.0037648, -0.0024871,
        -0.046266, -0.020668, -0.01388, 0.0011002, -0.0062123, 0.10518, 0.013829, 0.23026, 0.0085313, -0.063859,
        0.033786, 0.11288, -0.0074951, -0.0066642, 0.0013493, -0.0058981, 0.013911, -0.024361, 0.0019113, -0.00039883,
        -0.036404, 0.0032424, 0.0049376, -0.0027243, -0.021655, 0.0085313, 0.25383, -0.014117, -0.31351, -0.42016,
        0.0021956, -0.0009322, -0.007403, 0.0013236, -0.022396, -0.025673, -0.0049184, 0.023967, -0.0010418, 0.00038179,
        -0.0016956, 0.057356, 0.0018042, -0.063859, -0.014117, 0.22926, -0.24168, 0.21579, -0.00043485, 0.0084854,
        -0.00076685, -0.0085697, -0.020314, 0.031603, -0.00034338, -0.00016802, 0.0063175, -0.013279, -0.069076,
        -0.080334, -0.0064686, 0.033786, -0.31351, -0.24168, 3.4941, 0.92558, 0.030459, -0.0029788, 0.019945, 0.033199,
        -0.071638, -0.032082, -0.01591, 0.058757, 0.013531, -0.015193, -0.10946, 0.11891, 0.040139, 0.11288, -0.42016,
        0.21579, 0.92558, 5.0543, 0.022728, 0.0080558, 0.02797, -0.043515, -0.011666, -0.10122, -0.021462, 0.070672,
        -0.01384, 0.024737, 0.019426, -0.0037358, -0.090525, -0.0074951, 0.0021956, -0.00043485, 0.030459, 0.022728,
        0.11589, 0.001232, -0.00054868, -0.0019064, -0.0038627, -0.002634, -0.028728, 0.0028793, 0.011819, 0.0016424,
        0.0002232, 0.030583, 0.002856, -0.0066642, -0.0009322, 0.0084854, -0.0029788, 0.0080558, 0.001232, 0.010917,
        0.00027829, 0.0029556, -0.00091738, 0.0011399, -0.0014318, -0.00029312, 0.023761, 0.00080259, -0.023426,
        0.0033258, 0.020463, 0.0013493, -0.007403, -0.00076685, 0.019945, 0.02797, -0.00054868, 0.00027829, 0.0067434,
        -0.00014646, -0.0015768, -0.0022048, 0.00066654, -0.0061351, -0.0011758, -0.00028679, -5.0623e-05, -0.015559,
        -0.0016971, -0.0058981, 0.0013236, -0.0085697, 0.033199, -0.043515, -0.0019064, 0.0029556, -0.00014646,
        0.014226, -0.0027975, 0.0028759, -0.00027408, -0.0020085, 0.0037089, -0.005404, -0.0015872, 0.0061052,
        0.0037648, 0.013911, -0.022396, -0.020314, -0.071638, -0.011666, -0.0038627, -0.00091738, -0.0015768,
        -0.0027975, 0.013262, 0.0019772, 0.00013849, -0.0043756, -0.0017386, 0.001717, 0.0009487, -0.0075728,
        -0.0024871, -0.024361, -0.025673, 0.031603, -0.032082, -0.10122, -0.002634, 0.0011399, -0.0022048, 0.0028759,
        0.0019772, 0.017189, 0.00082475, -0.0050934, 0.0019924, -0.0020918, -0.00059513, -0.0077824, -0.046266,
        0.0019113, -0.0049184, -0.00034338, -0.01591, -0.021462, -0.028728, -0.0014318, 0.00066654, -0.00027408,
        0.00013849, 0.00082475, 0.21081, 0.016947, 0.010535, -0.012795, -0.070706, -0.0062716, -0.020668, -0.00039883,
        0.023967, -0.00016802, 0.058757, 0.070672, 0.0028793, -0.00029312, -0.0061351, -0.0020085, -0.0043756,
        -0.0050934, 0.016947, 0.36088, 0.0060574, -0.016695, 0.010989, -0.022735, -0.01388, -0.036404, -0.0010418,
        0.0063175, 0.013531, -0.01384, 0.011819, 0.023761, -0.0011758, 0.0037089, -0.0017386, 0.0019924, 0.010535,
        0.0060574, 0.12541, -0.006603, 0.0052021, -7.6639e-05, 0.0011002, 0.0032424, 0.00038179, -0.013279, -0.015193,
        0.024737, 0.0016424, 0.00080259, -0.00028679, -0.005404, 0.001717, -0.0020918, -0.012795, -0.016695, -0.006603,
        0.034744;

    Q112 << 0.18833, 0.00022375, -0.075388, -0.0064384, 0.0054959, -0.006593, -0.069312, -0.11975, 0.0060151, 0.0024578,
        -0.022389, 0.0063581, -0.0015193, 0.00015365, 0.0027289, -0.066553, 0.013266, 0.0022249, 0.00022375, 0.3562,
        0.015217, 0.10528, -0.0029647, 0.062971, -0.082395, 0.10061, -0.002833, 0.030831, 0.0039211, -0.016443,
        0.0054115, -0.0056069, -0.0029955, -0.01007, -0.024327, -0.00109, -0.075388, 0.015217, 0.1868, 0.012549,
        -0.017312, 0.013676, -0.0066862, 0.027286, -0.083375, 0.0011125, 0.016239, -0.0031489, 0.0029748, 0.0047284,
        -0.044155, -0.012692, -0.0062226, -0.0014278, -0.0064384, 0.10528, 0.012549, 0.22016, -0.0091334, -0.05435,
        0.016794, 0.17187, -0.0068711, -0.0070032, 0.0021308, -0.007983, 0.017403, -0.018389, 0.0022115, -0.00093109,
        -0.036525, 0.0035061, 0.0054959, -0.0029647, -0.017312, -0.0091334, 0.2498, -0.025767, -0.319, -0.43204,
        0.004219, -0.00060399, -0.0070446, 0.00012374, -0.019285, -0.027801, -0.0060695, 0.023502, -0.0016682,
        0.0014098, -0.006593, 0.062971, 0.013676, -0.05435, -0.025767, 0.25183, -0.23341, 0.27522, -0.0052317,
        0.0088752, 0.0013312, -0.0094138, -0.02279, 0.034743, -8.4568e-05, -0.0036588, 0.0047943, -0.013915, -0.069312,
        -0.082395, -0.0066862, 0.016794, -0.319, -0.23341, 3.4615, 0.7654, 0.030414, -0.0030133, 0.018789, 0.035372,
        -0.072279, -0.025966, -0.019542, 0.055754, 0.014399, -0.017541, -0.11975, 0.10061, 0.027286, 0.17187, -0.43204,
        0.27522, 0.7654, 5.5989, 0.022808, -0.0044637, 0.02816, -0.047902, -0.0042841, -0.10666, -0.022115, 0.073592,
        -0.010976, 0.027726, 0.0060151, -0.002833, -0.083375, -0.0068711, 0.004219, -0.0052317, 0.030414, 0.022808,
        0.11229, 0.0013647, 0.00050824, 0.0011136, -0.003677, -0.0028844, -0.027971, 0.0062707, 0.0032297, -0.00010224,
        0.0024578, 0.030831, 0.0011125, -0.0070032, -0.00060399, 0.0088752, -0.0030133, -0.0044637, 0.0013647, 0.011173,
        -0.00030418, 0.0034705, -0.00095302, 0.0021607, -0.0015605, 0.00093588, 0.025711, 0.00058113, -0.022389,
        0.0039211, 0.016239, 0.0021308, -0.0070446, 0.0013312, 0.018789, 0.02816, 0.00050824, -0.00030418, 0.006338,
        -0.00082055, -0.0015139, -0.002051, 0.0010235, -0.0060795, -0.001927, -0.00033163, 0.0063581, -0.016443,
        -0.0031489, -0.007983, 0.00012374, -0.0094138, 0.035372, -0.047902, 0.0011136, 0.0034705, -0.00082055, 0.014497,
        -0.002866, 0.0031318, -0.0005686, -0.0042296, 0.0050885, -0.005531, -0.0015193, 0.0054115, 0.0029748, 0.017403,
        -0.019285, -0.02279, -0.072279, -0.0042841, -0.003677, -0.00095302, -0.0015139, -0.002866, 0.013001, 0.0013576,
        0.00039106, -0.0040067, -0.0016515, 0.0016125, 0.00015365, -0.0056069, 0.0047284, -0.018389, -0.027801,
        0.034743, -0.025966, -0.10666, -0.0028844, 0.0021607, -0.002051, 0.0031318, 0.0013576, 0.019202, 0.00071469,
        -0.0051419, 0.001715, -0.002457, 0.0027289, -0.0029955, -0.044155, 0.0022115, -0.0060695, -8.4568e-05,
        -0.019542, -0.022115, -0.027971, -0.0015605, 0.0010235, -0.0005686, 0.00039106, 0.00071469, 0.20274, -0.010272,
        0.0028313, 0.0019778, -0.066553, -0.01007, -0.012692, -0.00093109, 0.023502, -0.0036588, 0.055754, 0.073592,
        0.0062707, 0.00093588, -0.0060795, -0.0042296, -0.0040067, -0.0051419, -0.010272, 0.34782, 0.017198, -0.0023723,
        0.013266, -0.024327, -0.0062226, -0.036525, -0.0016682, 0.0047943, 0.014399, -0.010976, 0.0032297, 0.025711,
        -0.001927, 0.0050885, -0.0016515, 0.001715, 0.0028313, 0.017198, 0.14112, -0.0062634, 0.0022249, -0.00109,
        -0.0014278, 0.0035061, 0.0014098, -0.013915, -0.017541, 0.027726, -0.00010224, 0.00058113, -0.00033163,
        -0.005531, 0.0016125, -0.002457, 0.0019778, -0.0023723, -0.0062634, 0.034872;

    Q121 << 0.18156, -0.016562, -0.076664, -0.0063446, 0.0074679, 0.0041188, -0.079364, -0.11191, 0.0082582, -0.0023613,
        -0.021395, -0.0065718, -0.0028628, 0.0011586, 0.0042948, -0.063866, 0.0086394, 0.007602, -0.016562, 0.35267,
        0.050278, 0.10597, 0.00049389, 0.068913, -0.053922, 0.12187, -0.0031342, 0.030122, 0.0036015, -0.01546,
        0.0044508, -0.0069891, -0.014871, 0.00057074, -0.025377, -0.0031424, -0.076664, 0.050278, 0.19166, 0.016347,
        -0.018415, -0.0051255, -0.01856, 0.041887, -0.083761, 0.0044719, 0.015828, -0.0011047, 0.010914, -0.0025849,
        -0.04524, -0.013579, -0.019706, 0.0027234, -0.0063446, 0.10597, 0.016347, 0.22263, 0.041487, -0.052008,
        -0.034088, 0.13208, -0.0075197, -0.0071322, 0.00062625, -0.0084082, 0.0050702, -0.029805, -0.00087038,
        0.0021734, -0.037145, 0.0033071, 0.0074679, 0.00049389, -0.018415, 0.041487, 0.24181, -0.0021513, -0.34123,
        -0.43781, 0.0050024, -0.0014786, -0.006912, 0.0029091, -0.023181, -0.021501, -0.0056609, 0.02183, -0.0017585,
        -0.00099939, 0.0041188, 0.068913, -0.0051255, -0.052008, -0.0021513, 0.2609, -0.31997, 0.20591, 0.0029565,
        0.0094181, -0.0028906, -0.0096855, -0.021495, 0.035782, 0.00066609, 0.0017437, 0.0050403, -0.013704, -0.079364,
        -0.053922, -0.01856, -0.034088, -0.34123, -0.31997, 3.9342, 0.76026, 0.026504, 0.011648, 0.018964, 0.037268,
        -0.073958, -0.025577, -0.016672, 0.059086, 0.0070463, -0.017196, -0.11191, 0.12187, 0.041887, 0.13208, -0.43781,
        0.20591, 0.76026, 5.143, 0.02269, 0.0090188, 0.026913, -0.045418, -0.0072264, -0.10173, -0.025288, 0.062723,
        -0.017725, 0.025197, 0.0082582, -0.0031342, -0.083761, -0.0075197, 0.0050024, 0.0029565, 0.026504, 0.02269,
        0.11323, 0.0020731, 0.00039743, -0.0029854, -0.0038023, -0.0025887, -0.027922, 0.0048849, 0.019289, 0.0024449,
        -0.0023613, 0.030122, 0.0044719, -0.0071322, -0.0014786, 0.0094181, 0.011648, 0.0090188, 0.0020731, 0.011105,
        0.0011191, 0.004007, -0.002105, 0.0011476, -0.0015508, -0.00096341, 0.025593, 0.00042839, -0.021395, 0.0036015,
        0.015828, 0.00062625, -0.006912, -0.0028906, 0.018964, 0.026913, 0.00039743, 0.0011191, 0.0060225, 0.00040891,
        -0.0013928, -0.0021369, 0.00086291, -0.0057535, -0.00023298, -0.00010056, -0.0065718, -0.01546, -0.0011047,
        -0.0084082, 0.0029091, -0.0096855, 0.037268, -0.045418, -0.0029854, 0.004007, 0.00040891, 0.015163, -0.0032639,
        0.0028919, -0.00071696, 0.0007143, 0.0063735, -0.0059345, -0.0028628, 0.0044508, 0.010914, 0.0050702, -0.023181,
        -0.021495, -0.073958, -0.0072264, -0.0038023, -0.002105, -0.0013928, -0.0032639, 0.015362, 0.0013804,
        -0.00010716, -0.0042567, -0.0013737, 0.0020483, 0.0011586, -0.0069891, -0.0025849, -0.029805, -0.021501,
        0.035782, -0.025577, -0.10173, -0.0025887, 0.0011476, -0.0021369, 0.0028919, 0.0013804, 0.017067, 0.00094964,
        -0.0045736, 0.0022887, -0.001984, 0.0042948, -0.014871, -0.04524, -0.00087038, -0.0056609, 0.00066609,
        -0.016672, -0.025288, -0.027922, -0.0015508, 0.00086291, -0.00071696, -0.00010716, 0.00094964, 0.20809,
        -0.0093235, 0.01895, -0.020057, -0.063866, 0.00057074, -0.013579, 0.0021734, 0.02183, 0.0017437, 0.059086,
        0.062723, 0.0048849, -0.00096341, -0.0057535, 0.0007143, -0.0042567, -0.0045736, -0.0093235, 0.33415,
        -0.0060675, -0.030768, 0.0086394, -0.025377, -0.019706, -0.037145, -0.0017585, 0.0050403, 0.0070463, -0.017725,
        0.019289, 0.025593, -0.00023298, 0.0063735, -0.0013737, 0.0022887, 0.01895, -0.0060675, 0.14254, -0.0046621,
        0.007602, -0.0031424, 0.0027234, 0.0033071, -0.00099939, -0.013704, -0.017196, 0.025197, 0.0024449, 0.00042839,
        -0.00010056, -0.0059345, 0.0020483, -0.001984, -0.020057, -0.030768, -0.0046621, 0.036777;

    Q122 << 0.16835, -0.0099718, -0.070596, -0.0076074, 0.0065736, -0.0022211, -0.075189, -0.12477, -0.0058192,
        0.00036999, -0.020012, 0.00033673, -0.0027312, 0.00075215, 0.01363, -0.054243, 0.011751, 0.0047714, -0.0099718,
        0.40207, 0.035973, 0.11137, -0.0014298, 0.079501, -0.052606, 0.098794, -0.0015018, 0.031468, 0.0044756,
        -0.017482, 0.0029165, -0.0037293, -0.010505, -0.0044892, -0.030101, -0.0030467, -0.070596, 0.035973, 0.17109,
        0.015835, -0.0091705, 0.0081351, -0.019904, 0.044314, -0.069691, 0.0023138, 0.01276, -0.0030946, 0.0088894,
        0.003197, -0.043258, -0.0030203, -0.013629, 0.00021251, -0.0076074, 0.11137, 0.015835, 0.20704, 0.021813,
        -0.033371, -0.095367, 0.2082, -0.0061249, -0.0085903, 0.0016019, -0.011963, 0.01015, -0.023153, -0.00025813,
        0.001063, -0.03929, 0.0042321, 0.0065736, -0.0014298, -0.0091705, 0.021813, 0.23474, -0.017459, -0.32925,
        -0.43486, 0.0032549, -0.0012424, -0.006151, 0.0015857, -0.01795, -0.022318, -0.0053232, 0.021235, -0.0023298,
        0.00014689, -0.0022211, 0.079501, 0.0081351, -0.033371, -0.017459, 0.29806, -0.31764, 0.29778, -0.0012179,
        0.011077, -0.00047343, -0.011036, -0.026563, 0.042717, -6.5091e-05, -0.0014895, 0.0023871, -0.014662, -0.075189,
        -0.052606, -0.019904, -0.095367, -0.32925, -0.31764, 3.7999, 0.055289, 0.022117, 0.013977, 0.016308, 0.04173,
        -0.071952, -0.0088619, -0.018736, 0.052482, 0.0074611, -0.019982, -0.12477, 0.098794, 0.044314, 0.2082,
        -0.43486, 0.29778, 0.055289, 5.771, 0.010255, -0.0096538, 0.026866, -0.054854, 0.0094924, -0.10732, -0.019021,
        0.061898, -0.015305, 0.029558, -0.0058192, -0.0015018, -0.069691, -0.0061249, 0.0032549, -0.0012179, 0.022117,
        0.010255, 0.10017, 0.002214, 0.0019364, 0.0002919, -0.0028006, -0.0016114, -0.024043, 0.0058169, 0.010634,
        0.00025775, 0.00036999, 0.031468, 0.0023138, -0.0085903, -0.0012424, 0.011077, 0.013977, -0.0096538, 0.002214,
        0.01178, 0.00046596, 0.0045371, -0.0024308, 0.0026781, -0.0013404, -3.5374e-05, 0.029942, 7.7505e-06, -0.020012,
        0.0044756, 0.01276, 0.0016019, -0.006151, -0.00047343, 0.016308, 0.026866, 0.0019364, 0.00046596, 0.0055134,
        -0.00030135, -0.0013332, -0.0020101, 0.00037848, -0.0054278, -0.0011189, -0.00018565, 0.00033673, -0.017482,
        -0.0030946, -0.011963, 0.0015857, -0.011036, 0.04173, -0.054854, 0.0002919, 0.0045371, -0.00030135, 0.015465,
        -0.0032966, 0.0032857, -0.00097464, -0.0017326, 0.0071924, -0.0058329, -0.0027312, 0.0029165, 0.0088894,
        0.01015, -0.01795, -0.026563, -0.071952, 0.0094924, -0.0028006, -0.0024308, -0.0013332, -0.0032966, 0.014728,
        -0.00053716, -9.0351e-05, -0.003755, -0.0012106, 0.0019479, 0.00075215, -0.0037293, 0.003197, -0.023153,
        -0.022318, 0.042717, -0.0088619, -0.10732, -0.0016114, 0.0026781, -0.0020101, 0.0032857, -0.00053716, 0.019419,
        0.0001975, -0.0045313, 0.001998, -0.0024447, 0.01363, -0.010505, -0.043258, -0.00025813, -0.0053232,
        -6.5091e-05, -0.018736, -0.019021, -0.024043, -0.0013404, 0.00037848, -0.00097464, -9.0351e-05, 0.0001975,
        0.17832, -0.044519, 0.011704, -0.0041237, -0.054243, -0.0044892, -0.0030203, 0.001063, 0.021235, -0.0014895,
        0.052482, 0.061898, 0.0058169, -3.5374e-05, -0.0054278, -0.0017326, -0.003755, -0.0045313, -0.044519, 0.28821,
        0.0052064, -0.015566, 0.011751, -0.030101, -0.013629, -0.03929, -0.0023298, 0.0023871, 0.0074611, -0.015305,
        0.010634, 0.029942, -0.0011189, 0.0071924, -0.0012106, 0.001998, 0.011704, 0.0052064, 0.1765, -0.0069264,
        0.0047714, -0.0030467, 0.00021251, 0.0042321, 0.00014689, -0.014662, -0.019982, 0.029558, 0.00025775,
        7.7505e-06, -0.00018565, -0.0058329, 0.0019479, -0.0024447, -0.0041237, -0.015566, -0.0069264, 0.036406;

    Q211 << 0.32647, -0.0355, -0.2663, 0.003858, -0.0035257, 0.013948, -0.10788, -0.24614, -0.0285, 0.0005284,
        -0.035307, 0.0038464, -0.014326, -0.0072169, 0.00098919, -0.10723, 0.032027, -0.01028, -0.0355, 0.87785,
        0.22674, 0.098967, -0.049594, 0.12227, -0.40872, 0.76303, -0.0060642, -0.010572, 0.017733, -0.075011, 0.04361,
        -0.05708, -0.014033, -0.0084372, -0.036588, -0.007866, -0.2663, 0.22674, 0.70221, 0.016277, -0.050867,
        -0.042605, 0.13499, 0.41605, -0.02064, -0.0024628, 0.077713, -0.023064, -0.0020083, -0.030666, -0.042655,
        -0.11582, -0.033735, 0.00057957, 0.003858, 0.098967, 0.016277, 0.19925, 0.025455, -0.015968, 0.084614,
        -0.060289, -0.001477, -0.0046127, 0.00055488, 0.006457, 0.0012496, -0.011571, -0.00092059, -0.0024127,
        0.0027421, -0.014832, -0.0035257, -0.049594, -0.050867, 0.025455, 0.74314, -0.10465, -0.8141, -1.3885,
        -0.0096452, -0.0012175, -0.015875, 0.010079, -0.011666, -0.028193, -0.0012738, 0.05302, -0.016235, 0.00096801,
        0.013948, 0.12227, -0.042605, -0.015968, -0.10465, 0.6704, -0.85687, 0.85336, 0.0084671, -0.011088, -0.0050289,
        -0.017583, -0.037232, 0.082024, -0.0011431, -0.014933, 0.069397, -0.023535, -0.10788, -0.40872, 0.13499,
        0.084614, -0.8141, -0.85687, 6.2899, -0.11427, 0.019397, -0.0027408, 0.030279, 0.066151, -0.062205, -0.028897,
        -0.014464, 0.054559, -0.012898, -0.010736, -0.24614, 0.76303, 0.41605, -0.060289, -1.3885, 0.85336, -0.11427,
        9.531, 0.01453, 0.01268, 0.058328, -0.095388, 0.02266, -0.13032, -0.01367, 0.12249, -0.023299, 0.013871,
        -0.0285, -0.0060642, -0.02064, -0.001477, -0.0096452, 0.0084671, 0.019397, 0.01453, 0.095387, 0.0043015,
        0.0081134, 0.0047135, -0.0041859, -0.0018598, -0.024261, 0.016361, 0.02207, 0.0032611, 0.0005284, -0.010572,
        -0.0024628, -0.0046127, -0.0012175, -0.011088, -0.0027408, 0.01268, 0.0043015, 0.019651, -0.00010083, 0.016921,
        0.0001441, -0.00034994, 0.00029676, 0.011185, 0.034841, 0.0090258, -0.035307, 0.017733, 0.077713, 0.00055488,
        -0.015875, -0.0050289, 0.030279, 0.058328, 0.0081134, -0.00010083, 0.011939, -0.0021667, -0.0027813, -0.0041094,
        0.00054537, -0.016151, -0.0015481, 0.00063335, 0.0038464, -0.075011, -0.023064, 0.006457, 0.010079, -0.017583,
        0.066151, -0.095388, 0.0047135, 0.016921, -0.0021667, 0.033351, -0.0057098, 0.0067263, -0.003882, 0.0052619,
        0.024241, -0.010016, -0.014326, 0.04361, -0.0020083, 0.0012496, -0.011666, -0.037232, -0.062205, 0.02266,
        -0.0041859, 0.0001441, -0.0027813, -0.0057098, 0.017743, -0.0046975, 0.0011707, 0.0023277, -0.005163, 0.0024456,
        -0.0072169, -0.05708, -0.030666, -0.011571, -0.028193, 0.082024, -0.028897, -0.13032, -0.0018598, -0.00034994,
        -0.0041094, 0.0067263, -0.0046975, 0.030923, 0.00016487, -0.0072887, 0.0075412, -0.0018074, 0.00098919,
        -0.014033, -0.042655, -0.00092059, -0.0012738, -0.0011431, -0.014464, -0.01367, -0.024261, 0.00029676,
        0.00054537, -0.003882, 0.0011707, 0.00016487, 0.16452, 0.024891, 0.018037, -0.00043743, -0.10723, -0.0084372,
        -0.11582, -0.0024127, 0.05302, -0.014933, 0.054559, 0.12249, 0.016361, 0.011185, -0.016151, 0.0052619,
        0.0023277, -0.0072887, 0.024891, 0.5496, 0.015399, 0.012372, 0.032027, -0.036588, -0.033735, 0.0027421,
        -0.016235, 0.069397, -0.012898, -0.023299, 0.02207, 0.034841, -0.0015481, 0.024241, -0.005163, 0.0075412,
        0.018037, 0.015399, 0.16797, 0.0019656, -0.01028, -0.007866, 0.00057957, -0.014832, 0.00096801, -0.023535,
        -0.010736, 0.013871, 0.0032611, 0.0090258, 0.00063335, -0.010016, 0.0024456, -0.0018074, -0.00043743, 0.012372,
        0.0019656, 0.046895;

    Q212 << 0.32823, -0.035014, -0.27703, 0.020962, -0.0024972, 0.015137, -0.10365, -0.26189, -0.040795, 0.0024216,
        -0.035539, 0.012221, -0.014961, -0.0078877, 0.017243, -0.10229, 0.036045, -0.015605, -0.035014, 0.94843,
        0.20372, 0.094203, -0.048604, 0.13746, -0.42554, 0.8874, -0.0019394, -0.016506, 0.020735, -0.086925, 0.047014,
        -0.058219, -0.0056291, -0.0091751, -0.038599, -0.010609, -0.27703, 0.20372, 0.67042, -0.0030935, -0.034655,
        -0.016078, 0.12269, 0.41494, -0.007484, -0.011382, 0.075431, -0.030686, -0.0035461, -0.021109, -0.045252,
        -0.10263, -0.031093, -0.00071245, 0.020962, 0.094203, -0.0030935, 0.20739, -0.030733, 0.021367, 0.012594,
        0.012706, -0.011167, -0.0061713, -0.0017101, 0.0034457, 0.0049264, 0.0015907, 0.0083213, -0.017198, 0.0091208,
        -0.015648, -0.0024972, -0.048604, -0.034655, -0.030733, 0.73635, -0.1262, -0.83971, -1.4319, -0.010906,
        0.0039122, -0.01467, 0.008831, -0.0086818, -0.029142, -0.0016833, 0.050555, -0.017103, 0.0024471, 0.015137,
        0.13746, -0.016078, 0.021367, -0.1262, 0.74554, -0.91396, 0.97387, 0.0018198, -0.012104, -0.0029133, -0.019651,
        -0.03998, 0.09548, 0.0026967, -0.022138, 0.076575, -0.026879, -0.10365, -0.42554, 0.12269, 0.012594, -0.83971,
        -0.91396, 6.4422, -0.49176, 0.014845, -0.0013948, 0.027686, 0.070791, -0.062658, -0.035759, -0.013673, 0.051094,
        -0.01323, -0.014088, -0.26189, 0.8874, 0.41494, 0.012706, -1.4319, 0.97387, -0.49176, 10.808, 0.0062259,
        0.0053692, 0.05858, -0.11309, 0.045455, -0.13973, -0.020494, 0.12451, -0.031389, 0.018825, -0.040795,
        -0.0019394, -0.007484, -0.011167, -0.010906, 0.0018198, 0.014845, 0.0062259, 0.099249, 0.0045169, 0.0096136,
        0.0070811, -0.0029497, -0.00056468, -0.027419, 0.011961, 0.0076582, 0.0022823, 0.0024216, -0.016506, -0.011382,
        -0.0061713, 0.0039122, -0.012104, -0.0013948, 0.0053692, 0.0045169, 0.020071, -0.0016593, 0.018823, 0.00049004,
        0.00033979, -0.0029146, 0.016094, 0.035969, 0.01064, -0.035539, 0.020735, 0.075431, -0.0017101, -0.01467,
        -0.0029133, 0.027686, 0.05858, 0.0096136, -0.0016593, 0.011743, -0.0033371, -0.0027729, -0.0042549, 0.00014978,
        -0.016314, -0.0027087, 0.000378, 0.012221, -0.086925, -0.030686, 0.0034457, 0.008831, -0.019651, 0.070791,
        -0.11309, 0.0070811, 0.018823, -0.0033371, 0.037908, -0.0059195, 0.0071274, -0.0054938, 0.0045513, 0.031589,
        -0.011927, -0.014961, 0.047014, -0.0035461, 0.0049264, -0.0086818, -0.03998, -0.062658, 0.045455, -0.0029497,
        0.00049004, -0.0027729, -0.0059195, 0.018363, -0.0054529, -0.0001377, 0.0017933, -0.0052336, 0.0024552,
        -0.0078877, -0.058219, -0.021109, 0.0015907, -0.029142, 0.09548, -0.035759, -0.13973, -0.00056468, 0.00033979,
        -0.0042549, 0.0071274, -0.0054529, 0.034828, -0.00035399, -0.0082406, 0.0092648, -0.0026417, 0.017243,
        -0.0056291, -0.045252, 0.0083213, -0.0016833, 0.0026967, -0.013673, -0.020494, -0.027419, -0.0029146,
        0.00014978, -0.0054938, -0.0001377, -0.00035399, 0.17118, -0.017526, 0.0070994, 0.010311, -0.10229, -0.0091751,
        -0.10263, -0.017198, 0.050555, -0.022138, 0.051094, 0.12451, 0.011961, 0.016094, -0.016314, 0.0045513,
        0.0017933, -0.0082406, -0.017526, 0.5385, 0.019885, 0.032724, 0.036045, -0.038599, -0.031093, 0.0091208,
        -0.017103, 0.076575, -0.01323, -0.031389, 0.0076582, 0.035969, -0.0027087, 0.031589, -0.0052336, 0.0092648,
        0.0070994, 0.019885, 0.18075, 0.0053237, -0.015605, -0.010609, -0.00071245, -0.015648, 0.0024471, -0.026879,
        -0.014088, 0.018825, 0.0022823, 0.01064, 0.000378, -0.011927, 0.0024552, -0.0026417, 0.010311, 0.032724,
        0.0053237, 0.055749;

    Q221 << 0.31433, -0.033921, -0.26394, -0.0054112, -0.0016131, 0.017092, -0.1112, -0.23276, -0.038338, -0.00048052,
        -0.034166, -0.00098667, -0.015524, -0.0072539, 0.013132, -0.10058, 0.032081, -0.0047043, -0.033921, 0.8792,
        0.25729, 0.092412, -0.053151, 0.12242, -0.39535, 0.76677, -0.0086727, -0.011472, 0.018017, -0.077557, 0.050061,
        -0.056298, -0.01787, -0.010713, -0.040864, -0.0072841, -0.26394, 0.25729, 0.6693, 0.030628, -0.034828,
        -0.053649, 0.098525, 0.4066, -0.010446, 0.003578, 0.072586, -0.021643, 0.0076672, -0.032349, -0.049178,
        -0.10084, -0.038074, 0.00016995, -0.0054112, 0.092412, 0.030628, 0.22327, 0.086297, 0.0010357, -0.0063307,
        0.036805, 0.0038086, -0.0048317, 0.0022177, 0.0064816, -0.0068383, -0.017746, -0.0044307, 0.0082707, 0.0030124,
        -0.014159, -0.0016131, -0.053151, -0.034828, 0.086297, 0.72152, -0.093229, -0.82236, -1.4061, -0.0097991,
        -0.0054195, -0.014638, 0.010541, -0.011686, -0.024138, -0.0014343, 0.04817, -0.016957, 0.00081812, 0.017092,
        0.12242, -0.053649, 0.0010357, -0.093229, 0.7078, -0.9742, 0.85651, 0.014865, -0.011527, -0.0057524, -0.018808,
        -0.034896, 0.084023, -0.0048982, -0.013411, 0.073426, -0.02511, -0.1112, -0.39535, 0.098525, -0.0063307,
        -0.82236, -0.9742, 6.6245, -0.32851, 0.0080539, 0.0047234, 0.02584, 0.064936, -0.060519, -0.032025, -0.015404,
        0.051156, -0.01861, -0.011211, -0.23276, 0.76677, 0.4066, 0.036805, -1.4061, 0.85651, -0.32851, 9.4184,
        0.0097404, 0.013055, 0.055231, -0.096519, 0.033255, -0.12769, -0.01301, 0.11246, -0.028132, 0.015727, -0.038338,
        -0.0086727, -0.010446, 0.0038086, -0.0097991, 0.014865, 0.0080539, 0.0097404, 0.10108, 0.0032754, 0.0096027,
        0.005756, -0.0027674, -0.00076662, -0.025396, 0.012072, 0.029811, 0.0010758, -0.00048052, -0.011472, 0.003578,
        -0.0048317, -0.0054195, -0.011527, 0.0047234, 0.013055, 0.0032754, 0.019161, 0.00094017, 0.017388, -0.00076786,
        -0.00027227, 0.0035207, 0.0097405, 0.032916, 0.010116, -0.034166, 0.018017, 0.072586, 0.0022177, -0.014638,
        -0.0057524, 0.02584, 0.055231, 0.0096027, 0.00094017, 0.011412, -0.0015715, -0.0027356, -0.0040306, 0.00035482,
        -0.015384, -0.0011412, 0.00044284, -0.00098667, -0.077557, -0.021643, 0.0064816, 0.010541, -0.018808, 0.064936,
        -0.096519, 0.005756, 0.017388, -0.0015715, 0.035573, -0.0060634, 0.0069374, -0.002346, 0.0031652, 0.026174,
        -0.011376, -0.015524, 0.050061, 0.0076672, -0.0068383, -0.011686, -0.034896, -0.060519, 0.033255, -0.0027674,
        -0.00076786, -0.0027356, -0.0060634, 0.020176, -0.0047028, 8.0101e-05, 0.0015274, -0.0043408, 0.0026688,
        -0.0072539, -0.056298, -0.032349, -0.017746, -0.024138, 0.084023, -0.032025, -0.12769, -0.00076662, -0.00027227,
        -0.0040306, 0.0069374, -0.0047028, 0.030363, -0.00075398, -0.0073784, 0.007713, -0.0018452, 0.013132, -0.01787,
        -0.049178, -0.0044307, -0.0014343, -0.0048982, -0.015404, -0.01301, -0.025396, 0.0035207, 0.00035482, -0.002346,
        8.0101e-05, -0.00075398, 0.17354, -0.0092189, 0.025296, 0.0030177, -0.10058, -0.010713, -0.10084, 0.0082707,
        0.04817, -0.013411, 0.051156, 0.11246, 0.012072, 0.0097405, -0.015384, 0.0031652, 0.0015274, -0.0073784,
        -0.0092189, 0.52027, 0.014845, -0.0032533, 0.032081, -0.040864, -0.038074, 0.0030124, -0.016957, 0.073426,
        -0.01861, -0.028132, 0.029811, 0.032916, -0.0011412, 0.026174, -0.0043408, 0.007713, 0.025296, 0.014845,
        0.17273, 0.0025455, -0.0047043, -0.0072841, 0.00016995, -0.014159, 0.00081812, -0.02511, -0.011211, 0.015727,
        0.0010758, 0.010116, 0.00044284, -0.011376, 0.0026688, -0.0018452, 0.0030177, -0.0032533, 0.0025455, 0.056394;

    Q222 << 0.31079, -0.032679, -0.27446, 0.013158, 0.0037768, 0.017463, -0.10641, -0.25097, -0.050685, 0.0028914,
        -0.034614, 0.0089646, -0.01737, -0.009198, 0.033389, -0.093362, 0.037214, -0.012868, -0.032679, 1.0021, 0.24695,
        0.077091, -0.050289, 0.14379, -0.46239, 0.94418, -0.0047948, -0.01988, 0.021782, -0.097421, 0.054308, -0.061006,
        -0.010621, -0.013409, -0.046517, -0.010962, -0.27446, 0.24695, 0.64809, 0.005915, -0.019818, -0.022982, 0.08146,
        0.41757, 0.0063647, -0.0083936, 0.071253, -0.030452, 0.0080507, -0.021374, -0.053801, -0.083636, -0.037579,
        -0.0015768, 0.013158, 0.077091, 0.005915, 0.20221, 0.015424, 0.034176, -0.076701, 0.0949, -0.0016649,
        -0.0050442, 0.0001198, 0.0061651, -0.0027087, -0.0031113, 0.001913, -0.0085191, 0.012346, -0.016956, 0.0037768,
        -0.050289, -0.019818, 0.015424, 0.72691, -0.12079, -0.84152, -1.4502, -0.013067, 0.00080888, -0.013566,
        0.0090745, -0.0086621, -0.025932, -0.0013214, 0.044764, -0.018701, 0.0023215, 0.017463, 0.14379, -0.022982,
        0.034176, -0.12079, 0.83669, -1.0689, 1.0342, 0.010502, -0.014729, -0.0029556, -0.021854, -0.042932, 0.10359,
        -0.002623, -0.020819, 0.086249, -0.031216, -0.10641, -0.46239, 0.08146, -0.076701, -0.84152, -1.0689, 7.0343,
        -1.047, 0.0017003, 0.0033121, 0.022259, 0.077017, -0.06233, -0.033848, -0.013179, 0.045762, -0.015758,
        -0.017156, -0.25097, 0.94418, 0.41757, 0.0949, -1.4502, 1.0342, -1.047, 11.081, -0.0071562, 0.0063698, 0.055316,
        -0.12223, 0.059389, -0.13898, -0.013777, 0.11303, -0.037657, 0.023095, -0.050685, -0.0047948, 0.0063647,
        -0.0016649, -0.013067, 0.010502, 0.0017003, -0.0071562, 0.10311, 0.0029102, 0.011444, 0.0072967, -0.0010627,
        0.001762, -0.029084, 0.0053301, 0.016923, 0.0012652, 0.0028914, -0.01988, -0.0083936, -0.0050442, 0.00080888,
        -0.014729, 0.0033121, 0.0063698, 0.0029102, 0.019923, -0.0010484, 0.01977, -0.00028434, 6.5043e-05, 0.0011372,
        0.015127, 0.034802, 0.013413, -0.034614, 0.021782, 0.071253, 0.0001198, -0.013566, -0.0029556, 0.022259,
        0.055316, 0.011444, -0.0010484, 0.011233, -0.0030267, -0.0023978, -0.0039235, -0.00062395, -0.014894,
        -0.0023938, 0.00027421, 0.0089646, -0.097421, -0.030452, 0.0061651, 0.0090745, -0.021854, 0.077017, -0.12223,
        0.0072967, 0.01977, -0.0030267, 0.042535, -0.0065001, 0.0076785, -0.0034282, 0.002729, 0.037631, -0.014751,
        -0.01737, 0.054308, 0.0080507, -0.0027087, -0.0086621, -0.042932, -0.06233, 0.059389, -0.0010627, -0.00028434,
        -0.0023978, -0.0065001, 0.02148, -0.005906, -0.0013737, 0.0010924, -0.0051619, 0.0032049, -0.009198, -0.061006,
        -0.021374, -0.0031113, -0.025932, 0.10359, -0.033848, -0.13898, 0.001762, 6.5043e-05, -0.0039235, 0.0076785,
        -0.005906, 0.035417, -0.0020276, -0.0080363, 0.0099668, -0.0027815, 0.033389, -0.010621, -0.053801, 0.001913,
        -0.0013214, -0.002623, -0.013179, -0.013777, -0.029084, 0.0011372, -0.00062395, -0.0034282, -0.0013737,
        -0.0020276, 0.17938, -0.056731, 0.015969, 0.012781, -0.093362, -0.013409, -0.083636, -0.0085191, 0.044764,
        -0.020819, 0.045762, 0.11303, 0.0053301, 0.015127, -0.014894, 0.002729, 0.0010924, -0.0080363, -0.056731,
        0.49373, 0.021549, 0.023632, 0.037214, -0.046517, -0.037579, 0.012346, -0.018701, 0.086249, -0.015758,
        -0.037657, 0.016923, 0.034802, -0.0023938, 0.037631, -0.0051619, 0.0099668, 0.015969, 0.021549, 0.19679,
        0.0082522, -0.012868, -0.010962, -0.0015768, -0.016956, 0.0023215, -0.031216, -0.017156, 0.023095, 0.0012652,
        0.013413, 0.00027421, -0.014751, 0.0032049, -0.0027815, 0.012781, 0.023632, 0.0082522, 0.072503;

    Q311 << 0.41056, -0.018336, -0.42843, -0.011785, 0.0043784, 0.047095, -0.29311, -0.42926, -0.031243, -0.014032,
        -0.039616, -0.006082, -0.032066, -0.030113, -0.059112, -0.17925, 0.061345, -0.01706, -0.018336, 1.5135, 0.57492,
        0.22362, -0.11486, 0.11805, -0.68911, 1.2751, 0.0016287, -0.00090073, 0.030279, -0.085221, 0.092844, -0.059796,
        -0.035287, -0.080104, -0.050732, 0.0084929, -0.42843, 0.57492, 1.7664, 0.064317, 0.0029092, -0.13986, 0.24998,
        0.59909, -0.061747, 0.017104, 0.13477, -0.036968, 0.012079, -0.013333, -0.039665, -0.27867, -0.12908, 0.005351,
        -0.011785, 0.22362, 0.064317, 0.53776, 0.224, -0.077008, 0.55779, -0.041711, -0.021173, -0.019348, -0.0030123,
        0.015755, -0.0097259, -0.036245, -0.0044942, 0.0033394, -0.018345, -0.027503, 0.0043784, -0.11486, 0.0029092,
        0.224, 1.4112, -0.15208, -2.4833, -3.0557, -0.0023468, -0.0032079, -0.011626, 0.017485, -0.038048, -0.057397,
        -0.0085715, 0.054471, -0.032277, 0.0041648, 0.047095, 0.11805, -0.13986, -0.077008, -0.15208, 0.99715, -1.931,
        1.0055, -0.0055713, -0.02972, -0.010552, -0.024574, -0.032839, 0.11433, 0.0024952, -0.029527, 0.091317,
        -0.032891, -0.29311, -0.68911, 0.24998, 0.55779, -2.4833, -1.931, 17.895, 5.9382, 0.0436, -0.0033582, 0.043588,
        0.080937, -0.15381, -0.17062, -0.023473, 0.17479, -0.068269, 0.0053203, -0.42926, 1.2751, 0.59909, -0.041711,
        -3.0557, 1.0055, 5.9382, 18.398, 0.080841, 0.035439, 0.064974, -0.097353, 0.01676, -0.19318, -0.021932, 0.26389,
        0.0019817, 0.008618, -0.031243, 0.0016287, -0.061747, -0.021173, -0.0023468, -0.0055713, 0.0436, 0.080841,
        0.20461, 0.02442, 0.0095285, 0.0029998, -0.0038926, -0.0079711, -0.047303, 0.059233, 0.040328, 0.021186,
        -0.014032, -0.00090073, 0.017104, -0.019348, -0.0032079, -0.02972, -0.0033582, 0.035439, 0.02442, 0.058307,
        0.0033392, 0.027983, 0.00077879, -0.0004522, -0.0076018, 0.018487, 0.049707, 0.02567, -0.039616, 0.030279,
        0.13477, -0.0030123, -0.011626, -0.010552, 0.043588, 0.064974, 0.0095285, 0.0033392, 0.013717, -0.0032395,
        -0.0022213, -0.00095246, 0.0064393, -0.017678, -0.0048523, 0.0014005, -0.006082, -0.085221, -0.036968, 0.015755,
        0.017485, -0.024574, 0.080937, -0.097353, 0.0029998, 0.027983, -0.0032395, 0.041489, -0.0087409, 0.0053002,
        -0.010869, 0.014512, 0.006953, -0.013221, -0.032066, 0.092844, 0.012079, -0.0097259, -0.038048, -0.032839,
        -0.15381, 0.01676, -0.0038926, 0.00077879, -0.0022213, -0.0087409, 0.038917, 0.0052514, -0.0024018, -0.0060382,
        -0.0054586, 0.0020127, -0.030113, -0.059796, -0.013333, -0.036245, -0.057397, 0.11433, -0.17062, -0.19318,
        -0.0079711, -0.0004522, -0.00095246, 0.0053002, 0.0052514, 0.043396, -0.00046181, -0.022938, 0.0017966,
        8.696e-05, -0.059112, -0.035287, -0.039665, -0.0044942, -0.0085715, 0.0024952, -0.023473, -0.021932, -0.047303,
        -0.0076018, 0.0064393, -0.010869, -0.0024018, -0.00046181, 0.35245, 0.2151, 0.03802, -0.023594, -0.17925,
        -0.080104, -0.27867, 0.0033394, 0.054471, -0.029527, 0.17479, 0.26389, 0.059233, 0.018487, -0.017678, 0.014512,
        -0.0060382, -0.022938, 0.2151, 0.82949, 0.097239, 0.01061, 0.061345, -0.050732, -0.12908, -0.018345, -0.032277,
        0.091317, -0.068269, 0.0019817, 0.040328, 0.049707, -0.0048523, 0.006953, -0.0054586, 0.0017966, 0.03802,
        0.097239, 0.20237, -0.0067143, -0.01706, 0.0084929, 0.005351, -0.027503, 0.0041648, -0.032891, 0.0053203,
        0.008618, 0.021186, 0.02567, 0.0014005, -0.013221, 0.0020127, 8.696e-05, -0.023594, 0.01061, -0.0067143,
        0.085159;

    Q312 << 0.38686, 0.0019053, -0.3927, 0.029437, 0.01147, 0.04997, -0.2947, -0.41157, -0.044284, -0.0087317, -0.038,
        0.0033373, -0.030781, -0.025042, -0.044841, -0.1553, 0.058474, -0.030274, 0.0019053, 1.7216, 0.51073, 0.15625,
        -0.1205, 0.11642, -0.77277, 1.5343, 0.013134, -0.011383, 0.032914, -0.1088, 0.090782, -0.059584, -0.023761,
        -0.068979, -0.055138, 0.0034566, -0.3927, 0.51073, 1.559, -0.074262, 0.014577, -0.13322, 0.25959, 0.60049,
        -0.051576, -0.021333, 0.1239, -0.05382, 0.0040596, -0.0099124, -0.03318, -0.26202, -0.11633, -0.0025925,
        0.029437, 0.15625, -0.074262, 0.37758, 0.03064, 0.0027851, 0.041227, -0.074484, -0.0099528, -0.013719,
        -0.0085069, 0.017044, 0.014979, 0.0015191, -0.0012723, -0.025794, 0.005895, -0.032363, 0.01147, -0.1205,
        0.014577, 0.03064, 1.3781, -0.1703, -2.4821, -2.9119, 0.0023806, 0.010219, -0.010067, 0.018792, -0.03249,
        -0.051819, -0.0085159, 0.048501, -0.030616, 0.003103, 0.04997, 0.11642, -0.13322, 0.0027851, -0.1703, 1.1255,
        -2.0709, 1.1264, -0.0034752, -0.030157, -0.0096315, -0.027242, -0.042947, 0.13378, -0.0027534, -0.034877,
        0.11277, -0.037308, -0.2947, -0.77277, 0.25959, 0.041227, -2.4821, -2.0709, 18.394, 4.1549, 0.063624, 0.0077959,
        0.045179, 0.1013, -0.15408, -0.17041, -0.038219, 0.1586, -0.057446, 0.00049909, -0.41157, 1.5343, 0.60049,
        -0.074484, -2.9119, 1.1264, 4.1549, 18.124, 0.058426, 0.02678, 0.065717, -0.12023, 0.053278, -0.19137,
        -0.021001, 0.24617, -0.0087155, 0.012273, -0.044284, 0.013134, -0.051576, -0.0099528, 0.0023806, -0.0034752,
        0.063624, 0.058426, 0.20097, 0.018306, 0.0092697, 0.0097315, -0.0040077, -0.0030646, -0.048137, 0.06373,
        0.020046, 0.018692, -0.0087317, -0.011383, -0.021333, -0.013719, 0.010219, -0.030157, 0.0077959, 0.02678,
        0.018306, 0.051174, -0.00072092, 0.030774, -0.00097693, -0.0015614, -0.0039179, 0.030392, 0.043973, 0.028556,
        -0.038, 0.032914, 0.1239, -0.0085069, -0.010067, -0.0096315, 0.045179, 0.065717, 0.0092697, -0.00072092,
        0.012887, -0.0044752, -0.0024841, -0.0015736, 0.0062241, -0.017772, -0.0055476, 0.0013346, 0.0033373, -0.1088,
        -0.05382, 0.017044, 0.018792, -0.027242, 0.1013, -0.12023, 0.0097315, 0.030774, -0.0044752, 0.047425, -0.010216,
        0.004242, -0.01391, 0.015588, 0.018358, -0.015655, -0.030781, 0.090782, 0.0040596, 0.014979, -0.03249,
        -0.042947, -0.15408, 0.053278, -0.0040077, -0.00097693, -0.0024841, -0.010216, 0.039586, 0.0030863, -0.0020419,
        -0.0054432, -0.0072598, 0.0028916, -0.025042, -0.059584, -0.0099124, 0.0015191, -0.051819, 0.13378, -0.17041,
        -0.19137, -0.0030646, -0.0015614, -0.0015736, 0.004242, 0.0030863, 0.045018, -0.0017112, -0.023038, 0.0042801,
        0.00012553, -0.044841, -0.023761, -0.03318, -0.0012723, -0.0085159, -0.0027534, -0.038219, -0.021001, -0.048137,
        -0.0039179, 0.0062241, -0.01391, -0.0020419, -0.0017112, 0.34797, 0.15705, 0.025356, 0.0085453, -0.1553,
        -0.068979, -0.26202, -0.025794, 0.048501, -0.034877, 0.1586, 0.24617, 0.06373, 0.030392, -0.017772, 0.015588,
        -0.0054432, -0.023038, 0.15705, 0.74909, 0.092631, 0.054162, 0.058474, -0.055138, -0.11633, 0.005895, -0.030616,
        0.11277, -0.057446, -0.0087155, 0.020046, 0.043973, -0.0055476, 0.018358, -0.0072598, 0.0042801, 0.025356,
        0.092631, 0.22762, 0.0011093, -0.030274, 0.0034566, -0.0025925, -0.032363, 0.003103, -0.037308, 0.00049909,
        0.012273, 0.018692, 0.028556, 0.0013346, -0.015655, 0.0028916, 0.00012553, 0.0085453, 0.054162, 0.0011093,
        0.098169;

    Q321 << 0.38193, -0.019481, -0.36735, -0.015291, 0.011538, 0.05635, -0.29434, -0.41068, -0.024947, -0.024125,
        -0.035033, -0.0042964, -0.029865, -0.031302, -0.055638, -0.1557, 0.058036, -0.0163, -0.019481, 1.4386, 0.62914,
        0.042107, -0.11031, 0.1031, -0.49782, 1.1793, -0.010753, -0.012924, 0.028594, -0.088743, 0.11173, -0.050282,
        -0.049235, -0.081552, -0.060948, 0.0045819, -0.36735, 0.62914, 1.6052, 0.073315, -0.0014288, -0.12665, 0.23861,
        0.59882, -0.052769, 0.029899, 0.12005, -0.045799, 0.02778, -0.013006, -0.058718, -0.26119, -0.1224, 0.002433,
        -0.015291, 0.042107, 0.073315, 0.58322, 0.28388, -0.070587, 0.61274, 0.010643, -0.014601, -0.015765,
        -0.00079351, 0.024574, -0.045046, -0.039342, -0.0070776, 0.019747, 9.3172e-05, -0.026299, 0.011538, -0.11031,
        -0.0014288, 0.28388, 1.357, -0.14136, -2.3215, -2.9901, -0.00012245, -0.0072709, -0.011463, 0.016507, -0.035148,
        -0.05141, -0.006217, 0.046573, -0.031425, 0.0045289, 0.05635, 0.1031, -0.12665, -0.070587, -0.14136, 1.0084,
        -2.0783, 0.91151, 0.0064375, -0.035077, -0.01032, -0.02377, -0.017294, 0.1071, -0.00184, -0.037594, 0.091004,
        -0.02836, -0.29434, -0.49782, 0.23861, 0.61274, -2.3215, -2.0783, 16.528, 5.277, -0.016046, 0.01987, 0.038777,
        0.072526, -0.14152, -0.17402, 0.0056438, 0.14705, -0.090197, 0.0022353, -0.41068, 1.1793, 0.59882, 0.010643,
        -2.9901, 0.91151, 5.277, 17.315, 0.053978, 0.028595, 0.061412, -0.084726, 0.029308, -0.17647, -7.5639e-05,
        0.2412, -0.0074785, 0.0063011, -0.024947, -0.010753, -0.052769, -0.014601, -0.00012245, 0.0064375, -0.016046,
        0.053978, 0.19749, 0.020194, 0.0083172, 0.0068359, 0.0019377, -0.0069038, -0.043301, 0.043826, 0.05722, 0.01428,
        -0.024125, -0.012924, 0.029899, -0.015765, -0.0072709, -0.035077, 0.01987, 0.028595, 0.020194, 0.049148,
        0.0041192, 0.027174, 0.0018869, 0.00087953, -0.0032641, 0.027571, 0.041243, 0.022958, -0.035033, 0.028594,
        0.12005, -0.00079351, -0.011463, -0.01032, 0.038777, 0.061412, 0.0083172, 0.0041192, 0.012321, -0.0030774,
        -0.0020145, -0.00079221, 0.0056138, -0.017051, -0.0040861, 0.0011725, -0.0042964, -0.088743, -0.045799,
        0.024574, 0.016507, -0.02377, 0.072526, -0.084726, 0.0068359, 0.027174, -0.0030774, 0.038573, -0.0088914,
        0.0043677, -0.0093862, 0.012886, 0.014894, -0.012615, -0.029865, 0.11173, 0.02778, -0.045046, -0.035148,
        -0.017294, -0.14152, 0.029308, 0.0019377, 0.0018869, -0.0020145, -0.0088914, 0.040412, 0.0070474, -0.0048177,
        -0.0060211, -0.0030238, 0.0023652, -0.031302, -0.050282, -0.013006, -0.039342, -0.05141, 0.1071, -0.17402,
        -0.17647, -0.0069038, 0.00087953, -0.00079221, 0.0043677, 0.0070474, 0.039689, -0.0021311, -0.021305,
        0.00076283, 0.00062764, -0.055638, -0.049235, -0.058718, -0.0070776, -0.006217, -0.00184, 0.0056438,
        -7.5639e-05, -0.043301, -0.0032641, 0.0056138, -0.0093862, -0.0048177, -0.0021311, 0.37356, 0.21265, 0.056127,
        -0.010194, -0.1557, -0.081552, -0.26119, 0.019747, 0.046573, -0.037594, 0.14705, 0.2412, 0.043826, 0.027571,
        -0.017051, 0.012886, -0.0060211, -0.021305, 0.21265, 0.75875, 0.099706, 0.013284, 0.058036, -0.060948, -0.1224,
        9.3172e-05, -0.031425, 0.091004, -0.090197, -0.0074785, 0.05722, 0.041243, -0.0040861, 0.014894, -0.0030238,
        0.00076283, 0.056127, 0.099706, 0.20498, -0.0015415, -0.0163, 0.0045819, 0.002433, -0.026299, 0.0045289,
        -0.02836, 0.0022353, 0.0063011, 0.01428, 0.022958, 0.0011725, -0.012615, 0.0023652, 0.00062764, -0.010194,
        0.013284, -0.0015415, 0.075163;

    Q322 << 0.35078, -0.00062318, -0.34058, 0.013327, 0.016599, 0.060007, -0.29354, -0.39382, -0.035786, -0.01672,
        -0.033302, 0.0013624, -0.028016, -0.02549, -0.040151, -0.13457, 0.05967, -0.029512, -0.00062318, 1.726, 0.57808,
        0.033699, -0.12084, 0.11683, -0.71868, 1.5276, 0.00022837, -0.023881, 0.032733, -0.11614, 0.1156, -0.053444,
        -0.03405, -0.075506, -0.06722, 0.0020577, -0.34058, 0.57808, 1.4304, -0.018558, 0.014203, -0.13353, 0.26929,
        0.61206, -0.0427, -0.0025588, 0.11156, -0.058418, 0.018313, -0.0084305, -0.048546, -0.23697, -0.11612,
        -0.0038463, 0.013327, 0.033699, -0.018558, 0.34835, 0.13154, 0.033291, 0.11014, 0.0020196, -0.0011331,
        -0.0083341, -0.0035204, 0.024525, -0.022093, -0.0059889, -0.0080928, -0.0014943, 0.021188, -0.032188, 0.016599,
        -0.12084, 0.014203, 0.13154, 1.3232, -0.16524, -2.2797, -2.8449, 0.00069829, 0.0035347, -0.0099924, 0.018869,
        -0.030658, -0.046669, -0.0070816, 0.042387, -0.03272, 0.0037211, 0.060007, 0.11683, -0.13353, 0.033291,
        -0.16524, 1.184, -2.3104, 1.0981, 0.0089458, -0.037857, -0.0097188, -0.028062, -0.034443, 0.13511, -0.009493,
        -0.039103, 0.11505, -0.038694, -0.29354, -0.71868, 0.26929, 0.11014, -2.2797, -2.3104, 17.347, 3.0806, 0.012961,
        0.027058, 0.0412, 0.10013, -0.14159, -0.17528, -0.016066, 0.13345, -0.075114, -0.0026426, -0.39382, 1.5276,
        0.61206, 0.0020196, -2.8449, 1.0981, 3.0806, 17.502, 0.023251, 0.018991, 0.061143, -0.11852, 0.079383, -0.18174,
        0.0013428, 0.22639, -0.02204, 0.012015, -0.035786, 0.00022837, -0.0427, -0.0011331, 0.00069829, 0.0089458,
        0.012961, 0.023251, 0.19051, 0.012062, 0.0087518, 0.013105, 0.00084712, -0.00074619, -0.044009, 0.049234,
        0.036089, 0.011271, -0.01672, -0.023881, -0.0025588, -0.0083341, 0.0035347, -0.037857, 0.027058, 0.018991,
        0.012062, 0.047599, 0.00077387, 0.031195, -0.00086854, -0.00034408, 0.0035365, 0.033922, 0.039961, 0.031527,
        -0.033302, 0.032733, 0.11156, -0.0035204, -0.0099924, -0.0097188, 0.0412, 0.061143, 0.0087518, 0.00077387,
        0.011654, -0.0041438, -0.0023768, -0.0012467, 0.0048109, -0.016324, -0.0049205, 0.0012954, 0.0013624, -0.11614,
        -0.058418, 0.024525, 0.018869, -0.028062, 0.10013, -0.11852, 0.013105, 0.031195, -0.0041438, 0.049357,
        -0.011059, 0.0039195, -0.010237, 0.017085, 0.024995, -0.015863, -0.028016, 0.1156, 0.018313, -0.022093,
        -0.030658, -0.034443, -0.14159, 0.079383, 0.00084712, -0.00086854, -0.0023768, -0.011059, 0.043301, 0.0040476,
        -0.0026181, -0.0059131, -0.0064701, 0.002834, -0.02549, -0.053444, -0.0084305, -0.0059889, -0.046669, 0.13511,
        -0.17528, -0.18174, -0.00074619, -0.00034408, -0.0012467, 0.0039195, 0.0040476, 0.043482, -0.0026682, -0.021513,
        0.0043878, 0.00025714, -0.040151, -0.03405, -0.048546, -0.0080928, -0.0070816, -0.009493, -0.016066, 0.0013428,
        -0.044009, 0.0035365, 0.0048109, -0.010237, -0.0026181, -0.0026682, 0.3422, 0.152, 0.042324, 0.023636, -0.13457,
        -0.075506, -0.23697, -0.0014943, 0.042387, -0.039103, 0.13345, 0.22639, 0.049234, 0.033922, -0.016324, 0.017085,
        -0.0059131, -0.021513, 0.152, 0.67184, 0.098226, 0.052326, 0.05967, -0.06722, -0.11612, 0.021188, -0.03272,
        0.11505, -0.075114, -0.02204, 0.036089, 0.039961, -0.0049205, 0.024995, -0.0064701, 0.0043878, 0.042324,
        0.098226, 0.23905, 0.0064085, -0.029512, 0.0020577, -0.0038463, -0.032188, 0.0037211, -0.038694, -0.0026426,
        0.012015, 0.011271, 0.031527, 0.0012954, -0.015863, 0.002834, 0.00025714, 0.023636, 0.052326, 0.0064085,
        0.10023;
  }

public:
  ~vant3_adaptiveMixCtrl2()
  {
  }

public:
  void config()
  {
  }

private:
  Double322 BumpFunction3dim(double Ub, double Ar, double Al, double DivUb[3][2], double DivAr[2][2],
                             double DivAl[2][2], double CenterUb[3], double CenterAr[2], double CenterAl[2],
                             double CutOffUb[3], double CutOffAr[2], double CutOffAl[2])
  {
    double BumpSetsUb[3];
    double BumpSetsAr[2];
    double BumpSetsAl[2];

    BumpSetsUb[0] = xii(Ub, CenterUb[0], CutOffUb[0]);
    BumpSetsUb[1] = xii(Ub, CenterUb[1], CutOffUb[1]);
    BumpSetsUb[2] = xii(Ub, CenterUb[2], CutOffUb[2]);

    BumpSetsAr[0] = xii(Ar, CenterAr[0], CutOffAr[0]);
    BumpSetsAr[1] = xii(Ar, CenterAr[1], CutOffAr[1]);

    BumpSetsAl[0] = xii(Al, CenterAl[0], CutOffAl[0]);
    BumpSetsAl[1] = xii(Al, CenterAl[1], CutOffAl[1]);

    double sum = 0;
    double Bump[3][2][2];
    for (int i = 0; i <= 2; i++)
    {
      for (int j = 0; j <= 1; j++)
      {
        for (int k = 0; k <= 1; k++)
        {
          Bump[i][j][k] = BumpSetsUb[i] * BumpSetsAr[j] * BumpSetsAl[k];
          sum += Bump[i][j][k];
        }
      }
    }

    Double322 n;
    for (int i = 0; i <= 2; i++)
    {
      for (int j = 0; j <= 1; j++)
      {
        for (int k = 0; k <= 1; k++)
        {
          n.Val[i][j][k] = Bump[i][j][k] / sum;
        }
      }
    }

    return n;
  }

private:
  double xii(double u, double center, double cutoff)
  {
    double w = (u - center) / cutoff;

    if (abs(w) < 1)
    {
      return pow(e, (-1.0 / (1.0 - pow(w, 2.0))));
    }
    else
    {
      return 0.0;
    }
  }

private:
  Eigen::VectorXd TrajetoriaReferenciaCompleta(double Tempo)
  {
    Eigen::VectorXd Traj(20);
    Tempo = Tempo / 1;
    // complete trajectory
    double X, Y, Z, Xp, Yp, Zp, Phi, Theta, Psi, Phip, Thetap, Psip, Ar, Al, Arp, Alp;
    Theta = -0.065;
    Thetap = 0.0;
    Phi = 0.0;
    Phip = 0.0;
    Ar = 0.065;
    Arp = 0.0;
    Al = 0.065;
    Alp = 0.0;
    double RT = 144.0;
    double T = 60.3186;
    // std::cout << Tempo << std::endl;
    if (Tempo < 20)
    {
      X = 0.0;
      Y = 0.0;
      Z = 1 + 0.5 * Tempo;
      Psi = 0.0;
      Xp = 0.0;
      Yp = 0.0;
      Zp = 0.5;
      Psip = 0.0;
    }
    else if (Tempo >= 20.0 && Tempo < 20.0 + 19.2)
    {
      Tempo = Tempo - 20.0;
      X = (0.7813 / 2) * pow(Tempo, 2.0);
      Y = 0.0;
      Z = 11.0;
      Psi = 0.0;
      Xp = (0.7813) * Tempo;
      Yp = 0.0;
      Zp = 0.0;
      Psip = 0.0;
    }
    else if ((Tempo >= 20.0 + 19.2) && (Tempo < 20.0 + 19.2 + 45.2389))
    {
      Tempo = Tempo - 20.0 - 19.2;

      X = RT * cos(((15.0 / 144.0) * Tempo) - (pi / 2.0)) + RT;
      Y = RT * sin(((15.0 / 144.0) * Tempo) - (pi / 2.0)) + RT;
      Z = 11 + 6 * sin((2 * pi / 22.6195) * Tempo);
      Psi = (Tempo / 45.2389) * (3.0 / 4.0) * 2.0 * pi;
      Xp = -(5 * RT * sin((5.0 * Tempo) / 48.0 - pi / 2.0)) / 48.0;
      Yp = (5 * RT * cos((5.0 * Tempo) / 48.0 - pi / 2.0)) / 48.0;
      // Zp = (8000.0*pi*cos((4000.0*pi*Tempo)/45239.0))/45239.0;
      Zp = (24000 * pi * cos((4000 * pi * Tempo) / 45239)) / 45239;
      Psip = (1.0 / 45.2389) * (3.0 / 4.0) * 2.0 * pi;
      // std::cout << "Entrei1" << std::endl;
    }
    else if (Tempo >= 20.0 + 19.2 + 45.2389 && Tempo < 20.0 + 19.2 + 45.2389 + 19.2)
    {
      // std::cout << "Entrei2" << std::endl;
      Tempo = Tempo - 20.0 - 19.2 - 45.2389;
      X = 0.0;
      Y = RT + (0.7826 / 2.0) * pow(Tempo, 2) - 15.0 * Tempo;
      Z = 11.0;
      Psi = (3.0 / 4.0) * 2.0 * pi;
      Xp = 0.0;
      Yp = -15.0 + (0.7826) * Tempo;
      Zp = 0.0;
      Psip = 0.0;
    }
    else if (Tempo >= 20.0 + 19.2 + 45.2389 + 19.2 && Tempo <= 20 + 19.2 + 45.2389 + 19.2 + 20.0)
    {
      Tempo = Tempo - (20 + 19.2 + 45.2389 + 19.2);
      X = 0.0;
      Y = 0.0;
      Z = 1.0 + 0.5 * (20.0 - Tempo);
      Psi = (3.0 / 4.0) * 2.0 * pi;
      Xp = 0.0;
      Yp = 0.0;
      Zp = -0.5;
      Psip = 0.0;
    }
    else
    {
      X = 0.0;
      Y = 0.0;
      Z = 1.0;
      Psi = (3.0 / 4.0) * 2.0 * pi;
      Xp = 0.0;
      Yp = 0.0;
      Zp = 0.0;
      Psip = 0.0;
    }

    //   // just rotate in psi
    //		if(Tempo < 40)
    //		{
    //			X = 0.0;
    //			Y = 0.0;
    //			Z = 1.0;
    //			Psi = -(2*pi)*Tempo/40;
    //			Xp = 0.0;
    //			Yp = 0.0;
    //			Zp = 0.0;
    //			Psip = -2*pi/40;
    //		}
    //		else{
    //			X = 0.0;
    //			Y = 0.0;
    //			Z = 1.0;
    //			Psi = -2*pi;
    //			Xp = 0.0;
    //			Yp = 0.0;
    //			Zp = 0.0;
    //			Psip = 0.0;
    //		}

    // Maps to the body
    Eigen::MatrixXd RIB(3, 3);
    Eigen::MatrixXd W_n(3, 3);
    Eigen::VectorXd XpYpZp(3);
    Eigen::VectorXd PhipThetapPsip(3);
    Eigen::VectorXd UVW(3);
    Eigen::VectorXd PQR(3);

    XpYpZp << Xp, Yp, Zp;
    PhipThetapPsip << Phip, Thetap, Psip;

    RIB << (cos(Psi) * cos(Theta)), (cos(Psi) * sin(Phi) * sin(Theta) - cos(Phi) * sin(Psi)),
        (sin(Phi) * sin(Psi) + cos(Phi) * cos(Psi) * sin(Theta)), (cos(Theta) * sin(Psi)),
        (cos(Phi) * cos(Psi) + sin(Phi) * sin(Psi) * sin(Theta)),
        (cos(Phi) * sin(Psi) * sin(Theta) - cos(Psi) * sin(Phi)), (-sin(Theta)), (cos(Theta) * sin(Phi)),
        (cos(Phi) * cos(Theta));
    W_n << 1.0, 0.0, -sin(Theta), 0.0, cos(Phi), cos(Theta) * sin(Phi), 0.0, -sin(Phi), cos(Phi) * cos(Theta);

    UVW = RIB.transpose() * XpYpZp;
    PQR = W_n * PhipThetapPsip;

    Traj << UVW(0), UVW(1), UVW(2), PQR(0), PQR(1), PQR(2), Arp, Alp, X, Y, Z, Phi, Theta, Psi, Ar, Al, 0.0, 0.0, 0.0,
        0.0;

    // simple reference
    //		Traj << 0,0,0,0,     0,0,     0,      0, //uvwpqr arp alp
    //				0,0,1,0,-0.065,0,0.065, 0.065, //xyzphithetapsi ar al
    //                0,0,0,0;

    return Traj;
  }

private:
  Eigen::VectorXd MakeXref(Eigen::VectorXd Trajectory)
  {
    Eigen::VectorXd xRef(18);
    xRef << Trajectory(0), Trajectory(1), Trajectory(2), Trajectory(3), Trajectory(4), Trajectory(5),  // uvw pqr
        Trajectory(6), Trajectory(7),                                                                  // arp alp
        Trajectory(10),                                                                                // z
        Trajectory(11), Trajectory(12), Trajectory(13), Trajectory(14), Trajectory(15),  // phi theta psi ar al
        Trajectory(16), Trajectory(17), Trajectory(18), Trajectory(19);                  // integrators
    return xRef;
  }

public:
  std::vector<double> execute(simulator_msgs::SensorArray arraymsg)
  {
    // read data from sensors
    simulator_msgs::Sensor msg;
    msg = arraymsg.values.at(0);
    // msg: x y z phi theta psi alphar alphal xp yp zp phip thetap psip alpharp alphalp
    static double PsiAnt = 0;

    // Map inertial velocity to body velocity
    double phi = msg.values.at(3);
    double theta = msg.values.at(4);
    double psi = msg.values.at(5);
    RI_B << (cos(psi) * cos(theta)), (cos(psi) * sin(phi) * sin(theta) - cos(phi) * sin(psi)),
        (sin(phi) * sin(psi) + cos(phi) * cos(psi) * sin(theta)), (cos(theta) * sin(psi)),
        (cos(phi) * cos(psi) + sin(phi) * sin(psi) * sin(theta)),
        (cos(phi) * sin(psi) * sin(theta) - cos(psi) * sin(phi)), (-sin(theta)), (cos(theta) * sin(phi)),
        (cos(phi) * cos(theta));

    Eigen::MatrixXd XpYpZp(3, 1);
    Eigen::MatrixXd PhipThetapPsip(3, 1);
    Eigen::MatrixXd WIIB(3, 1);
    Eigen::MatrixXd uvw(3, 1);
    Eigen::MatrixXd pqr(3, 1);
    XpYpZp << msg.values.at(8), msg.values.at(9), msg.values.at(10);
    WIIB << msg.values.at(11), msg.values.at(12), msg.values.at(13);
    uvw = RI_B.transpose() * XpYpZp;
    pqr = RI_B.transpose() * WIIB;

    // build reference values
    static double Tempo = 0;
    Trajectory = TrajetoriaReferenciaCompleta(Tempo);
    Tempo = Tempo + T;
    Xref = MakeXref(Trajectory);

    // State vector: u v w p q r alpharp alphalp z phi theta psi alphar alphal intz intu intv intpsi
    X << uvw(0), uvw(1), uvw(2), pqr(0), pqr(1), pqr(2), msg.values.at(14), msg.values.at(15), msg.values.at(2),
        msg.values.at(3), msg.values.at(4), msg.values.at(5), msg.values.at(6), msg.values.at(7), 0, 0, 0, 0;
    // Deal's with Psi Discontinuity at 180 degree
    if (X(11) - Xref(11) < -pi)
    {
      X(11) = X(11) + 2 * pi;
    }
    else if (X(11) - Xref(11) > pi)
    {
      X(11) = X(11) - 2 * pi;
    }

    // kinematic controller
    // proportional
    Xk << Trajectory(8) - msg.values.at(0), Trajectory(9) - msg.values.at(1), 0;  // x-xr, y-yr
    Uk << Trajectory(0), Trajectory(1), Trajectory(2);
    Kk << 1, 0, 0, 0, 0.5, 0, 0, 0, 3;
    // integral
    Kki << 0.07, 0, 0, 0, 0.05, 0, 0, 0, 0.07;
    static double xint, x_ant = 0;
    static double yint, y_ant = 0;

    double x_atual = Trajectory(8) - msg.values.at(0);
    xint = xint + (T / 2) * (x_atual + x_ant);
    x_ant = x_atual;

    double y_atual = Trajectory(9) - msg.values.at(1);
    yint = yint + (T / 2) * (y_atual + y_ant);
    y_ant = y_atual;

    Xki << xint, yint, 0;

    // kinematic controller  action
    Dk = Kk * RI_B.transpose() * Xk + Kki * RI_B.transpose() * Xki + Uk;
    Xref(0) = Dk(0);
    Xref(1) = Dk(1);
    Xref(2) = Dk(2);

    // Trapez integral intz intu intv intpsi
    static double ubint, ub_ant = 0;
    static double vbint, vb_ant = 0;
    static double zint, z_ant = 0;
    static double yawint, yaw_ant = 0;

    double ub_atual = X(0) - Xref(0);
    ubint = ubint + (T / 2) * (ub_atual + ub_ant);
    ub_ant = ub_atual;

    double vb_atual = X(1) - Xref(1);
    vbint = vbint + (T / 2) * (vb_atual + vb_ant);
    vb_ant = vb_atual;

    double z_atual = X(8) - Xref(8);
    zint = zint + (T / 2) * (z_atual + z_ant);
    z_ant = z_atual;

    double yaw_atual = X(11) - Xref(11);
    yawint = yawint + (T / 2) * (yaw_atual + yaw_ant);
    yaw_ant = yaw_atual;

    X(14) = zint;
    X(15) = ubint;
    X(16) = vbint;
    X(17) = yawint;

    // Computing adaptive mixing

    // Split Sets - parameters[0 8; 7 12; 11 17];
    static double DivUb[3][2] = { { 0, 8.0 }, { 7.0, 12.0 }, { 11.0, 17.0 } };
    static double DivAr[2][2] = { { -0.2, 0.05 }, { -0.05, 0.2 } };
    static double DivAl[2][2] = { { -0.2, 0.05 }, { -0.05, 0.2 } };
    static double CenterUb[3] = { 4, 9.5, 14 };
    static double CenterAr[2] = { -0.0750, 0.0750 };
    static double CenterAl[2] = { -0.0750, 0.0750 };
    static double CutOffUb[3] = { 4.0, 2.5, 3 };
    static double CutOffAr[2] = { 0.1250, 0.1250 };
    static double CutOffAl[2] = { 0.1250, 0.1250 };
    double Ub = uvw(0);
    double Ar = msg.values.at(6);
    double Al = msg.values.at(7);

    // Saturation values
    if (Ub < 0.1)
    {
      Ub = 0.1;
    }
    else if (Ub > 16.99)
    {
      Ub = 16.99;
    }

    if (Ar < -0.19)
    {
      Ar = -0.19;
    }
    else if (Ar > 0.19)
    {
      Ar = 0.19;
    }

    if (Al < -0.19)
    {
      Al = -0.19;
    }
    else if (Al > 0.19)
    {
      Al = 0.19;
    }

    // performing the adaptive mixing
    Double322 Psi;
    Psi = BumpFunction3dim(Ub, Ar, Al, DivUb, DivAr, DivAl, CenterUb, CenterAr, CenterAl, CutOffUb, CutOffAr, CutOffAl);
    // std::cout << std::endl;
    // std::cout << Ub << Ar << Al;

    Yu = Psi.Val[0][0][0] * Y111 + Psi.Val[0][0][1] * Y112 + Psi.Val[0][1][0] * Y121 + Psi.Val[0][1][1] * Y122 +
         Psi.Val[1][0][0] * Y211 + Psi.Val[1][0][1] * Y212 + Psi.Val[1][1][0] * Y221 + Psi.Val[1][1][1] * Y222 +
         Psi.Val[2][0][0] * Y311 + Psi.Val[2][0][1] * Y312 + Psi.Val[2][1][0] * Y321 + Psi.Val[2][1][1] * Y322;

    Qu = Psi.Val[0][0][0] * Q111 + Psi.Val[0][0][1] * Q112 + Psi.Val[0][1][0] * Q121 + Psi.Val[0][1][1] * Q122 +
         Psi.Val[1][0][0] * Q211 + Psi.Val[1][0][1] * Q212 + Psi.Val[1][1][0] * Q221 + Psi.Val[1][1][1] * Q222 +
         Psi.Val[2][0][0] * Q311 + Psi.Val[2][0][1] * Q312 + Psi.Val[2][1][0] * Q321 + Psi.Val[2][1][1] * Q322;

    K = Yu * Qu.inverse();

    // Control law
    Erro = (X - Xref);
    Input = K * Erro + Uref;

    if (Input(0) > 12)
    {
      Input(0) = 12;
    }
    if (Input(1) > 12)
    {
      Input(1) = 12;
    }
    if (Input(2) > 1)
    {
      Input(2) = 1;
    }
    if (Input(2) < -1)
    {
      Input(2) = -1;
    }
    if (Input(3) > 1)
    {
      Input(3) = 1;
    }
    if (Input(3) < -1)
    {
      Input(3) = -1;
    }
    if (Input(4) > pi / 9)
    {
      Input(4) = pi / 9;
    }
    if (Input(4) < -pi / 9)
    {
      Input(4) = -pi / 9;
    }
    if (Input(5) > pi / 9)
    {
      Input(5) = pi / 9;
    }
    if (Input(5) < -pi / 9)
    {
      Input(5) = -pi / 9;
    }

    // data to be saved
    SaveData(0) = uvw(0);
    SaveData(1) = uvw(1);
    SaveData(2) = uvw(2);
    SaveData(3) = pqr(0);
    SaveData(4) = pqr(1);
    SaveData(5) = pqr(2);
    SaveData(6) = msg.values.at(14);
    SaveData(7) = msg.values.at(15);
    SaveData(8) = msg.values.at(0);
    SaveData(9) = msg.values.at(1);
    SaveData(10) = msg.values.at(2);
    SaveData(11) = msg.values.at(3);
    SaveData(12) = msg.values.at(4);
    SaveData(13) = X(11);
    SaveData(14) = msg.values.at(6);
    SaveData(15) = msg.values.at(7);
    SaveData(16) = Tempo;

    SaveDataRef(0) = Xref(0);
    SaveDataRef(1) = Xref(1);
    SaveDataRef(2) = Xref(2);
    SaveDataRef(3) = Trajectory(3);
    SaveDataRef(4) = Trajectory(4);
    SaveDataRef(5) = Trajectory(5);
    SaveDataRef(6) = Trajectory(6);
    SaveDataRef(7) = Trajectory(7);
    SaveDataRef(8) = Trajectory(8);
    SaveDataRef(9) = Trajectory(9);
    SaveDataRef(10) = Trajectory(10);
    SaveDataRef(11) = Trajectory(11);
    SaveDataRef(12) = Trajectory(12);
    SaveDataRef(13) = Trajectory(13);
    SaveDataRef(14) = Xref(12);
    SaveDataRef(15) = Xref(13);
    SaveDataRef(16) = Tempo;

    SaveDataError = SaveData - SaveDataRef;
    // fprintf (stderr, "Fr: %f Fl: %f tr: %f tl: %f de: %f dr: %f\n",
    // Input(0),Input(1),Input(2),Input(3),Input(4),Input(5)); apply control inputs
    std::vector<double> out(Input.data(), Input.data() + Input.rows() * Input.cols());
    return out;
  }

public:
  std::vector<double> Reference()
  {
    std::vector<double> out(SaveDataRef.data(), SaveDataRef.data() + SaveDataRef.rows() * SaveDataRef.cols());
    return out;
  }

public:
  std::vector<double> Error()
  {
    std::vector<double> out(SaveDataError.data(), SaveDataError.data() + SaveDataError.rows() * SaveDataError.cols());
    return out;
  }

public:
  std::vector<double> State()
  {
    std::vector<double> out(SaveData.data(), SaveData.data() + SaveData.rows() * SaveData.cols());
    return out;
  }
};

extern "C" {
Icontroller* create(void)
{
  return new vant3_adaptiveMixCtrl2;
}
void destroy(Icontroller* p)
{
  delete p;
}
}
